---
sidebar: sidebar 
permalink: dp-sec/cleondris_best_practices.html 
keywords:  
summary:  
---
= ベストプラクティス： NetApp HCI DR と Cleondris
:hardbreaks:
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/




== 成功のための推奨事項

次のヒントは、 BCDR の作業をより成功させるのに役立ちます。



=== アプリケーション

アプリケーションとその機能を理解する。これらの作業に費やす時間が増えるほど、実際のフェールオーバーとテストフェールオーバーでより多くの成功を収めることができます。問題が発生した場合は、迅速に解決できます。

最初に 1 つのアプリケーションを保護します。比較的シンプルなものを選択し、ピアと管理に対するテストフェールオーバーのデモを行います。このデモでは、管理とピアサポートについて説明します。このテストは、他のアプリケーションを保護する前に詳細を確認するのに役立ちます。

階層 1 のアプリケーションは、それぞれ独自のボリュームに配置する必要があります。



=== 練習

できるだけ現実的なシナリオで練習する必要があります。たとえば、ホテルの会議室では、インターネットの質が悪いオフサイトで練習することがあります。練習は頻繁にキーであり、アプリケーションチーム X がアプリケーション Y を回復するようにチームを変更することを試みます。このアプローチは知識の共有に役立ちます。



=== エグゼクティブスポンサー

エグゼクティブスポンサーがいることを確認します。チームがうまく連携していない場合、またはアプリケーションチームがリカバリ時間に見合うものである必要がある場合は、経営幹部のサポートが必要です。



=== 部分的または全体的な停止を計画する

ディザスタリカバリイベントのほとんどは部分的なイベントなので、ティア 1 アプリケーションをリカバリしても、すべてをリカバリする必要はありません。



=== トリガー日時

フェイルオーバーを練習するだけでなく、フェイルオーバーをトリガーする権限のある他のユーザを管理することも練習します。フェイルオーバーを実行するには練習が必要であり ' フェイルオーバーが成功したか失敗したかを知る必要がありますできるだけ現実的なシナリオで練習してください。運用担当者が問題を抱え、マネージャーがその対応について話し合う、砂のテーブル型演習を行うことができます。



=== ディザスタリカバリが失敗するのはなぜですか？

ディザスタリカバリ計画が失敗する理由はいくつかあります。

* BCDR が必要です。
* 態度が欠けている：人々は、できる限り気にしていない。
* エグゼクティブスポンサーがないか、割り当てられていません。
* 十分な練習がないか、または十分に現実ではありません。
* テストのデータが製品に入ります。この状況は深刻であり、避ける必要があります。




== ディザスタリカバリオーケストレーションツールの追加の用途

時間の経過とともに、ディザスタリカバリオーケストレーションツールの用途も明らかになりました。たとえば、テストフェイルオーバーでアプリケーションと OS のアップグレードをテストします。このテストは、実際の本番ビットを使用するため、ラボでテストするよりも適切です。つまり、本番環境で実行した場合のプロセスは、テストフェイルオーバーと同様にスムーズになります。また、どのアプリケーションに悪影響を及ぼす可能性があるかを判断するために、最初にテストフェイルオーバーとしてセキュリティ脆弱性テストを実行しました。



== アクティブ / アクティブサイト

現在、アクティブ / アクティブサイトを保護するには、両方のサイトに HCC をインストールし、通常どおり保護する必要があります。現在、保護の概要はありません。アプリケーションを 2 つのサイトに分割できるため、アクティブ / アクティブ構成が最適なモデルです。停止が発生した場合は、半分のフェイルオーバーしか必要ありません。



== テストフェールオーバーで追加リソースを許可します

場合によっては、適切なアプリケーションテストを実行できるように、テストフェイルオーバーにより多くのリソースを確保しなければならないことがあります。たとえば、これらのリソースは、物理的なアンチスパムアプライアンスやロードバランサなどで構成されている場合があります。テストデータが本番環境に移行しないようにする必要があるため、原因の問題につながる可能性のあるデータベースなども含めることができます。このプロセスを確実に実行するには、次の手順をガイドラインとして使用してください。

. ディザスタリカバリテストプロセスでスクリプトが実行されます（必要に応じて手動プロセスを使用します）。
. 独立した論理パーティション（ LPAR ）が作成されます。
. 仮想ネットワークは個別の LPAR に追加され、テストネットワークにすでに接続されています。
. スクリプトは、適切なデータを別の LPAR および新しい LPAR にエクスポートおよびコピーします。アプリケーションを別のパーティションに配置する必要がある場合もあります。
. この新しいサーバにアクセスするには、 DNS 名やテストネットワーク内のアプリケーションの設定を調整する必要があります。
. テストは正常に完了しました。
. テストが完了し、クリーンアップが行われると、別のスクリプトが実行され、別のパーティションが削除されます。このステップは、誤って本番環境に移行することがないようにします。


同様のプロセスを使用して、ドメインコントローラをテストフェールオーバーにすることができます。

. ディザスタリカバリサイトのドメインコントローラの電源をオフにします。別のドメインコントローラが実行中であることを確認します。
. ドメインコントローラがオフになったら、クローンを作成します。
. 元のドメインコントローラの電源を入れます。
. クローニングしたドメインコントローラをテストネットワークに配置します。
. クローンドメインコントローラの電源をオンにします。
. ドメインコントローラは、認証と DNS のどちらの目的で使用するかに関係なく、今すぐテストできる必要があります。
. テストが完了したら、クローニングしたドメインコントローラを削除します。ドメインデータベースが実稼働ドメインと通信しないようにするため、この手順は省略しないでください。


これらの手順をスクリプト化し、リカバリプランからスクリプトを実行することをお勧めします。ただし、そのためには、テストフェイルオーバーと実際のフェイルオーバーのどちらで実行されているかを示すスクリプトまたはバッチファイルが必要です。また、実際のフェイルオーバーでは、何も実行されません。



== syslog

syslog を使用して Cleondris からイベントをキャプチャすると便利です。セキュリティや処理などのグループにはメリットがあります。

. これを行うには、 [ セットアップ ] ページと [ イベント ] タブを使用します。次に、 [Add Receiver] ボタンを使用します。


image:cleondris_image52.png["エラー：グラフィックイメージがありません"]

. 送信するイベントを指定します。この例では、すべてのファイルを今すぐ送信することをお勧めします。ボックスを選択します。一部のボックスは Cleondris HCC と BCDR には適用されませんが、使用しない場合は生成されません。


BCDR イベントは、リストの下部にある [Events] セクションに表示されます。

image:cleondris_image37.png["エラー：グラフィックイメージがありません"]



== VM の状態

VM の状態はフェイルオーバー中も維持されます。本番環境で電源をオンまたはオフにした VM は、フェイルオーバー後またはテストフェイルオーバー中も同じ状態のままです。ただし、 HCC は 20 分ごとに vCenter をスキャンする点に注意してください。そのため、そのスキャンを待つか、 HCC の更新ボタンを使用してただちに更新する必要があります。

image:cleondris_image46.png["エラー：グラフィックイメージがありません"]



== 実行専用アカウントを追加します

実行専用アカウントは、マネージャが変更を保存せずにフェールオーバーをトリガーする場合に役立ちます。このアカウントは自分で作成します。まず、次の権限を持つロールを作成します。

* ログインします
* inventory_sF_VIEW
* inventory_vc_view を選択します
* restore_exec_sf_failover
* failover_view のように指定します
* failover_job_modify のように指定します
* failover_config_view のように指定します


ロールが完了したら、そのロールを持つユーザを作成します。作成されたアカウントは実行専用アカウントになります。この一連の権限により、ユーザーは変更内容を確認して変更できますが、変更内容は保存されません。



== アイドルタイムアウト

このパラメータを設定すると、ブラウザで処理が行われていないときに自動ログアウトを実行できます。別のタブでの作業は、アクティビティとしてカウントされます。

[ セットアップ ] オプションを選択し、 [ 詳細設定 ] タブを選択して、 [ 詳細設定 ] ウィンドウを表示します。

image:cleondris_image47.png["エラー：グラフィックイメージがありません"]

[ オプションを追加（ Add Option ） ] ボタンをクリックして、オプションと値を追加する。上記のスクリーンショットでは、ブラウザにアクティビティがない場合、タイムアウトの前に 360 秒が経過している必要があります。



== インベントリの再スキャン

インベントリの再スキャン設定は、 VM の状態を維持する必要がある場合に使用します。たとえば、本番環境で VM がオフになっている場合は、フェイルオーバー時に電源をオンにしないでください。再スキャン間隔の値は、 5 分から 1440 分で設定できます。デフォルトでは 20 分に設定されています。

image:cleondris_image48.png["エラー：グラフィックイメージがありません"]

前のスクリーンショットでは、間隔は 10 分に設定されています。

この設定を行うと、 vCenter の再スキャン時間および SolidFire の再スキャン時間も変更される点に注意してください。



== 一般的なサポート

以下のベストプラクティスに従うことで、 Cleondris の操作性が向上し、サポートを支援できます。

* サポートを依頼する際は、必ずサポートバンドルを指定してください。


image:cleondris_image49.png["エラー：グラフィックイメージがありません"]

* 場合によっては、追加のロギングがサポートに非常に役立ちます。追加のログを有効にして、再度問題が発生したアクションを実行します。定期的にこのレベルをデバッグする必要がないので 'log.level を削除できます


image:cleondris_image50.png["エラー：グラフィックイメージがありません"]

* vCSA がビジー状態の vCenter Server Appliance （ vCSA ） CAN 原因の問題です。この問題を最小限に抑えるために、 vCSA にメモリを追加します。
* この問題は、テストフェイルオーバーで 1 台または 2 台の VM がクリーンアップされない可能性があることが原因で発生する場合もあります。これらの VM は、次の手順でクリーンアップできます。
+
** VM の電源をオフにします。この処理には時間がかかることがあります。
** インベントリから VM を削除します。多くの場合、この 2 つの手順でデータストアが表示されなくなります。次に、ストレージの再スキャン操作を実行します。



