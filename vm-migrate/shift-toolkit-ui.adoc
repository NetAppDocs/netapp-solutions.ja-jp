---
sidebar: sidebar 
permalink: vm-migrate/shift-toolkit-ui.html 
keywords: netapp, vmware, esxi, vm, migration, openshift, virtualization, hyper-v, proxmox 
summary:  
---
= Shift Toolkit GUIのセットアップと使用
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
このセクションでは、ユーザインターフェイスを使用してShift Toolkitをセットアップおよび実行する方法について説明します。



== Run Shiftツールキット

* ブラウザを使用して、インストール時に指定したアドレス>:3001"を入力してShift Toolkit UIにアクセスします"http://<IP[]。
+

NOTE: 最高のエクスペリエンスを得るには、Google ChromeまたはInternet Explorerを使用してください。

* 次のデフォルトクレデンシャルを使用してUIにアクセスします。
+
ユーザ名：admin

+
パスワード：admin




NOTE: adminクレデンシャルは、[Change Password]オプションを使用して変更できます。

image:shift-toolkit-image18.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

[Accept and Continue]をクリックして、法的EULAに同意します。

image:shift-toolkit-image19.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]



== Shiftツールキットの設定

ストレージとソースハイパーバイザーとデスティネーションハイパーバイザーの両方への接続を適切に設定したら、FlexClone機能を活用して、仮想マシンVMDKの移行または適切な形式への変換を自動化するためのShiftツールキットの設定を開始します。



=== サイトの追加

最初に、ソースvCenterを検出して追加し、次にターゲットHyper-Vの詳細（ハイパーバイザーとストレージの両方）をShiftツールキットに追加します。サポートされているブラウザでShiftツールキットを開き、デフォルトのユーザ名とパスワード（admin/admin）を使用して、[Add Sites]をクリックします。

image:shift-toolkit-image20.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]


NOTE: [検出]オプションを使用してサイトを追加することもできます。

次のプラットフォームを追加します。

* 出典 *

* ソースサイトの詳細
+
** Site Name：サイトの名前を指定します。
** ハイパーバイザー–ソースとしてVMwareを選択（GA時にのみ選択可能）
** [サイトの場所]–デフォルトオプションを選択します。
** コネクタ（Connector）-デフォルトの選択を選択します。




入力したら、[続行]をクリックします。

image:shift-toolkit-image21.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

* ソースのvCenter
+
** Endpoint - vCenter ServerのIPアドレスまたはFQDNを入力します。
** Username - vCenterにアクセスするためのユーザ名（UPN形式： `username@domain.com`）
** vCenter Password–リソースのインベントリを実行するためにvCenterにアクセスするためのパスワード。
** vCenter SSL Thumbprint（オプション）




[Accept Self Signed Certificate]を選択し、[Continue]をクリックします。

image:shift-toolkit-image22.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

* ONTAPストレージシステムのクレデンシャル


image:shift-toolkit-image23.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

Shiftツールキットを追加すると、自動検出が実行され、VMと関連するメタデータ情報が表示されます。Shift Toolkitでは、VMで使用されているネットワークとポートグループが自動的に検出され、自動的に設定されます。


NOTE: ソースサイトに変更が加えられた場合は、検出を実行して最新情報を取得してください。これを行うには、サイト名に対して3つの点をクリックし、[Discover Site]をクリックします。


NOTE: VMインベントリは24時間ごとに自動更新されます。

image:shift-toolkit-image24.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

特定のvCenterのデータを表示するには、ダッシュボードに移動し、該当するサイト名の[View VM List]をクリックします。VMインベントリとVM属性がページに表示されます。

次の手順では、デスティネーションハイパーバイザーを追加します。追加するには、[Add New Site]をクリックし、[Destination]を選択します。

* 目的地 *

image:shift-toolkit-image25.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

* デスティネーションサイトの詳細
+
** Site Name：サイトの名前を指定します。
** ハイパーバイザー–ターゲットとしてHyper-VまたはKVMを選択します。
** [サイトの場所]–デフォルトオプションを選択します。
** コネクタ（Connector）-デフォルトの選択を選択します。




入力したら、[続行]をクリックします。

image:shift-toolkit-image26.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

ハイパーバイザーの選択に基づいて、必要な詳細を入力します。

* デスティネーションHyper-Vの詳細
+
** Hyper-VスタンドアロンまたはフェイルオーバークラスタマネージャのIPアドレスまたはFQDN
** Username -アクセスするユーザ名（UPN形式： `username@domain.com`またはdomain\administrator）
+
password–リソースのインベントリを実行するためにHyper-VホストまたはFCIインスタンスにアクセスするためのパスワード。

+
[Accept Self Signed Certificate]を選択し、[Continue]をクリックします。





image:shift-toolkit-image27.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

完了したら、[続行]をクリックします


NOTE: Shift Toolkitは、現在のリリースではSystem Centerと直接通信しません。


NOTE: Hyper-V FCIとホストの検出は、DNSによる解決に依存します。ホスト名がShiftツールキットVMから解決可能であることを確認してください。解決に失敗した場合は、ホストファイル（C：\Windows\System32\drivers\etc\hosts）を更新し、検出処理を再試行します。

* ONTAPストレージシステム*

image:shift-toolkit-image28.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]


NOTE: ソースとデスティネーションのストレージシステムは、ボリュームレベルおよび同じボリューム内で行われるディスクフォーマット変換と同じである必要があります。

image:shift-toolkit-image29.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

次の手順では、必要なVMを移行グループにリソースグループとしてグループ化します。



== リソースのグループ化

プラットフォームを追加したら、移行または変換するVMをリソースグループにグループ化します。Shift Toolkitリソースグループを使用すると、依存VMのセットを、ブート順序とブート遅延を含む論理グループにグループ化できます。


NOTE: リソースグループを作成する前に、（前提条件のセクションを参照して）qtreeがプロビジョニングされていることを確認してください。

リソースグループの作成を開始するには、[Create New Resource Group]メニュー項目をクリックします。

. リソースグループにアクセスし、[Create New Resource Group]をクリックします。
+
image:shift-toolkit-image30.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

. [New resource group]で、ドロップダウンからソースサイトを選択し、[Create]をクリックします。
. リソースグループの詳細を指定し、ワークフローを選択します。ワークフローには2つのオプションがあります
+
.. クローンベースの移行–VMをソースハイパーバイザーからデスティネーションハイパーバイザーにエンドツーエンドで移行します。
.. クローンベースの変換–ディスクフォーマットを選択したハイパーバイザータイプに変換します。
+
image:shift-toolkit-image31.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]



. [Continue]をクリックします。
. 検索オプションを使用して適切なVMを選択します。デフォルトのフィルタオプションは[Datastore]です。
+

NOTE: 変換前に、新しく作成したONTAP SVM上の指定したデータストアに変換または移行するVMを移動します。これにより、本番用NFSデータストアと指定したデータストアを分離して、仮想マシンのステージングに使用できるようになります。

+
image:shift-toolkit-image32.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

+

NOTE: このコンテキストの[データストア]ドロップダウンには、NFSv3データストアのみが表示されます。NFSv4データストアは表示されません。

+
image:shift-toolkit-image33.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

. [Destination Site]、[Destination Hyper-V entry]、および[Datastore to qtree mapping]を選択して、マイグレーションの詳細を更新します。
+
image:shift-toolkit-image34.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

+

NOTE: VMをESXからHyper-Vに変換するときは、デスティネーションパス（変換されたVMが格納されている場所）がqtreeに設定されていることを確認します。デスティネーションパスを適切なqtreeに設定します。

+

NOTE: 複数のqtreeを作成して、変換したVMディスクの格納に使用できます。

. 選択したすべてのVMのBoot Order（起動順序）とBoot delay（秒）を選択します。各仮想マシンを選択し、優先順位を設定して、パワーオンシーケンスの順序を設定します。3は、すべての仮想マシンのデフォルト値です。
+
オプションは次のとおりです。

+
1–最初にパワーオンする仮想マシン3 -デフォルト5 -最後にパワーオンする仮想マシン

+
image:shift-toolkit-image35.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

. [Create Resource Group]をクリックします。
+
image:shift-toolkit-image36.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

+

NOTE: 仮想マシンを追加または削除するためにリソースグループを変更する必要がある場合は、リソースグループ名にドットが3つ表示された状態で[Edit Resource Group]を選択します。





=== 青写真

仮想マシンを移行または変換するには、プランが必要です。ドロップダウンからソースとデスティネーションのハイパーバイザープラットフォームを選択し、このブループリントに含めるリソースグループと、アプリケーションの電源をオンにする方法のグループ（ドメインコントローラ、ティア1、ティア2など）を選択します。これらは、多くの場合、移行計画とも呼ばれます。ブループリントを定義するには、「ブループリント」タブに移動し、「新規ブループリントの作成」をクリックします。

ブループリントの作成を開始するには、「新規ブループリントの作成」をクリックします。

. Blueprintsにアクセスし、「Create New Blueprint」をクリックします。
+
image:shift-toolkit-image37.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

. [New Blueprint]で、[Source Site]>[Associated VCenter]、[Destination Site]、および関連するHyper-Vハイパーバイザーを選択して、計画の名前を指定し、必要なホストマッピングを追加します。
. マッピングが完了したら、クラスタとホストのマッピングを選択します。
+
image:shift-toolkit-image38.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

. [Resource Group Details]を選択し、[Continue]をクリックします。
+
image:shift-toolkit-image39.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

. リソースグループの実行順序を設定します。このオプションを使用すると、複数のリソースグループが存在する場合の処理の順序を選択できます。
. 完了したら、適切な仮想スイッチへのネットワークマッピングを選択します。仮想スイッチは、Hyper-V内でプロビジョニング済みである必要があります。
+
image:shift-toolkit-image40.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

+

NOTE: Hyper-V側では、ネットワーク選択でサポートされるオプションは仮想スイッチタイプ「External」のみです。

+

NOTE: テスト移行では、[Do no configure Network]がデフォルトで選択され、Shift ToolkitではIPアドレスの割り当ては実行されません。ディスクを変換してHyper-V側で仮想マシンを購入したら、バブルネットワークスイッチを手動で割り当てて、本番ネットワークとの競合を回避します。

+
image:shift-toolkit-image41.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

. 選択したVMに基づいて、ストレージマッピングが自動的に選択されます。
+

NOTE: 仮想マシンを作成してSMB共有からパワーオンできるように、qtreeが事前にプロビジョニングされ、必要な権限が割り当てられていることを確認してください。

. [VM details]で、各OSタイプのサービスアカウントと有効なユーザクレデンシャルを指定します。これは、仮想マシンに接続して、VMware Toolsの削除やIP構成の詳細のバックアップに必要な特定のスクリプトを作成および実行するために使用されます。
+
.. WindowsベースのOSの場合は、ローカル管理者のPrivilegesを持つユーザを使用することを推奨します。ドメインクレデンシャルも使用できますが、変換前にVMにユーザプロファイルが存在することを確認してください。存在しない場合、ネットワークに接続されていないときにドメイン認証が検索されるため、ドメインクレデンシャルは機能しません。
.. LinuxディストリビューションベースのゲストVMの場合は、sudoコマンドをパスワードなしで実行できるユーザを指定します。つまり、ユーザがsudoersリストに含まれているか、/etc/sudoers.d/フォルダに新しい構成ファイルとして追加されている必要があります。
+
image:shift-toolkit-image42.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]



. [VM details]で、該当するIP設定オプションを選択します。デフォルトでは、[Do not configure]が選択されています。
+
.. 同じIPのVMをソースシステムから移行する場合は、[Retain IP]を選択します。
.. ソースシステムで静的IPを使用してVMを移行し、ターゲットVMにDHCPを割り当てるには、[DHCP]を選択します。
+
この機能を使用するには、次の要件を満たしていることを確認してください。

+
*** VMの準備フェーズ中に、スケジュールされた移行時間までVMの電源がオンになっていることを確認します。
*** VMware VMの場合は、VMware Toolsがインストールされていることを確認します。
*** 準備スクリプトがソースVMで実行されていることを確認します。Windows OSでは管理者Privileges、LinuxベースのディストリビューションOSではパスワードオプションなしのsudo Privilegesを使用してcronジョブを作成します。




. 次の手順はVMの構成です。
+
.. 必要に応じて、VMのCPU / RAMパラメータのサイズを変更します。これは、サイズ変更に非常に役立ちます。
.. Boot Order override：リソースグループ全体で選択したすべてのVMのBoot OrderとBoot Delay（秒）も変更します。これは、リソースグループのブート順序の選択時に選択した内容から変更が必要な場合に、ブート順序を変更するための追加オプションです。デフォルトでは、リソースグループの選択時に選択されたブート順序が使用されますが、この段階で変更を行うことができます。
.. Power On：ワークフローで仮想マシンの電源をオンにしない場合は、このオプションをオフにします。デフォルトのオプションはonで、VMの電源がオンになります。
.. VMwareツールを削除します。Shift Toolkitは、変換後にVMwareツールを削除します。このオプションはデフォルトで選択されています。お客様独自にカスタマイズしたスクリプトを実行する場合は、このオプションを選択解除できます。
.. Generation：Shift Toolkitでは、次の経験則が使用され、デフォルトでは適切なOne-Gen1 >BIOSおよびGen2 >EFIが使用されます。このオプションは選択できません。
.. Retain MAC：各VMのMACアドレスを保持して、MACに依存するアプリケーションのライセンスに関する課題を解決できます。
.. サービスアカウントオーバーライド:このオプションを使用すると、グローバルアカウントを使用できない場合に、別のサービスアカウントを指定できます。
+
image:shift-toolkit-image43.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]



. [Continue]をクリックします。
. 次の手順では、チェックボックスをオンにして日時を設定し、移行をスケジュールします。スケジュールされた日付までに、すべての仮想マシン（VM）の準備が完了し、電源がオフになっていることを確認します。完了したら、「ブループリントの作成」をクリックします。
+
image:shift-toolkit-image44.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

+

NOTE: スケジュール設定時に、Shift VMの現在の時刻より少なくとも30分前の日付を選択します。これは、ワークフローがリソースグループ内のVMを準備するのに十分な時間を確保するためです。

. ブループリントが作成されると、prepareVMジョブが開始され、ソースVMに対してスクリプトが自動的に実行されて移行に備えます。
+
image:shift-toolkit-image45.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

+
このジョブでは、Invoke-VMScriptメソッドを使用してスクリプトを実行し、VMware Toolsの削除やネットワーク構成の詳細（IPアドレス、ルート、DNS情報など）のバックアップに必要なスクリプトをコピーします。これらのスクリプトは、ターゲットVMで同じ設定を維持するために使用されます。

+
** Windowsベースのオペレーティングシステムでは、準備スクリプトが保存されるデフォルトの場所は「NetApp」フォルダです。
+
image:shift-toolkit-image46.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

** LinuxベースのVMの場合、準備スクリプトが格納されるデフォルトの場所は、/opt NetAppディレクトリと/optディレクトリです。
+
image:shift-toolkit-image47.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

+

NOTE: CentOSまたはRed Hatを実行するLinuxソースVMの場合、Shift Toolkitは必要なHyper-Vドライバを自動的にインストールするためのインテリジェントなツールキットです。これらのドライバは、変換後にVMが正常に起動できるように、ディスク変換前にソースVMに存在している必要があります。

+

NOTE: 詳細については、を参照してくださいlink:https://access.redhat.com/solutions/3465011["RHEL VMをHyper-Vに移行したあとにシステムがdracutで停止する"]。

+
下のスクリーンショットに示すように、prepareVMジョブが正常に完了すると、VMの移行準備が完了し、ブループリントのステータスが「Active」に更新されます。

+
image:shift-toolkit-image48.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

+
image:shift-toolkit-image49.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

+
移行は設定された時間に実行されるようになりました。または、[移行]オプションをクリックして手動で開始できます。







== 監視とダッシュボード

ジョブ監視を使用してジョブのステータスを監視します。

image:shift-toolkit-image76.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

直感的なUIで、移行、変換、青写真のステータスを自信を持って評価できます。これにより、管理者は、移行または変換されたVMの数とともに、成功した、失敗した、または部分的に失敗した計画を迅速に特定できます。

image:shift-toolkit-image77.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]



== 詳細設定

Shiftツールキットには、上部ツールバーの[設定]アイコンをクリックしてアクセスできる詳細設定が用意されています。

image:shift-toolkit-image78.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]



=== CredSSP

Shiftは、Credential Security Service Provider（CredSSP）を利用してクレデンシャル転送を管理します。変換プロセス中、Shiftサーバは、変換対象のVMのゲストOSに対して複数のスクリプトを実行します。これらのスクリプトを実行するためのクレデンシャルは、「ダブルホップ」を介してShiftサーバからゲストOSにHyper-Vサーバ経由で渡されます。

image:shift-toolkit-image79.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

* CredSSPクライアントとしてのShiftサーバの設定：*

[Advanced Settings]ウィザードでは、ShiftサーバがCredSSPクライアントとして自動的に設定されます。これにより、ShiftサーバからHyper-Vサーバにクレデンシャルを委譲できます。

*舞台裏で何が起こるか:*

Shiftツールキットは、一連のコマンドを実行して自身をクライアントとして設定し、Hyper-Vホストを管理できるようにします。このプロセスには、必要な構成のセットアップが含まれます。

* 次のコマンドを実行します。
+
** Set-Item WSMan：\localhost\Client\TrustedHosts -Value "FQDN-of-Hyper-V-host"
** Enable-WSManCredSSP -ロールクライアント- DelegateComputer「FQDN-of-Hyper-V-host」


* 次のグループポリシーを設定します。
+
** ［コンピュータの構成］>［管理用テンプレート］>［システム］>［資格情報の委任］>［NTLMのみのサーバー認証で新しい資格情報の委任を許可する］




[有効化]を選択して、WSMAN/FQDN-of-Hyper-Vホストを追加します。

* CredSSPサーバとしてのHyper-Vサーバの設定*

Hyper-VサーバをCredSSPサーバとして設定するには、Hyper-VサーバでEnable-WSManCredSSPコマンドレットを使用します。これにより、Hyper-VサーバがShiftサーバからクレデンシャルを受信できるようになります。

仮想マシンをShiftツールキットサーバでプロビジョニングするHyper-Vホストで、管理者としてWindows PowerShellセッションを開き、次のコマンドを実行します。

. イネーブル- PSRemoting
. Enable-WSManCredSSP -ロールサーバ




=== スワガー

[Advanced]設定の[swagger]ページでは、使用可能なAPIとのやり取りが可能です。ShiftツールキットのREST APIで使用できるリソースは、Swagger APIドキュメントページに表示されるカテゴリ別に分類されています。各リソースの簡単な説明と基本リソースパスを次に示します。また、必要に応じて使用上のその他の考慮事項も示します。

image:shift-toolkit-image80.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

*セッション*

このAPIを使用して、Shift Toolkit Serverにログインできます。このAPIは、後続の要求の認証に使用されるユーザ認証トークンを返します。

* セッションの開始
* セッションの検証
* すべてのSession IDを取得
* セッションを終了する


*コネクタ*

* コネクタの追加
* すべてのコネクタの詳細を確認
* コネクタの詳細をIDで更新
* コネクタの詳細をIDで取得


*テナント*

APIを使用して追加処理と取得処理を実行する

* テナントの追加
* すべてのテナントを取得


* ユーザー *

APIを使用して追加、取得、変更、承認の各処理を実行

* ユーザを追加
* すべてのユーザを取得
* ユーザのパスワードの変更
* EULAに同意する


* CredSSP*

APIを使用して有効化処理とGET処理を実行する

* CredSSPを有効にする
* CredSSPのステータスを取得


*サイト*

APIを使用して取得、追加、削除、更新の各処理を実行

* サイト数を取得
* サイトの詳細をすべて表示
* サイトの追加
* IDによるサイト詳細の取得
* IDによるサイトの削除
* サイトへの仮想環境の追加
* サイトへのストレージ環境の追加
* サイトの仮想環境の詳細を取得する
* サイトの仮想環境の詳細の更新
* サイトの仮想環境の詳細を削除する
* サイトのストレージ環境の詳細を取得する
* サイトのストレージ環境の詳細を更新する
* サイトのストレージ環境の詳細を削除する


*ディスカバリー*

APIを使用して検出処理と取得処理を実行

* ソースサイトの検出
* ソースサイトのすべての検出要求を取得
* ターゲットサイトの検出
* ターゲットサイトのすべての検出要求を取得する
* ソースサイトの検出手順をID別に取得
* ターゲットサイトの検出手順をID別に取得


*仮想マシン*

APIを使用してGET処理を実行する

* ソースでサイトと仮想環境のVMを取得
* サイトおよび仮想環境の保護されていないVMの取得
* VM数を取得
* 保護対象のVM数を取得


* リソース *

APIを使用してGET処理を実行する

* サイトおよび仮想環境のリソースの詳細を取得する
* ソースサイトのリソース数の取得


*リソースグループ*

APIを使用して追加、更新、GETの各処理を実行

* 保護グループ数の取得
* 保護グループの詳細をすべて取得
* 保護グループの追加
* ID別の保護グループの詳細を取得する
* IDによる保護グループの削除
* 保護グループの詳細をID別に更新
* IDによる保護グループのVMの取得
* 保護グループを含むブループリントの取得


*ブループリント*

APIを使用して追加、更新、GETの各処理を実行

* ブループリントカウントの取得
* Blueprintの詳細をすべて表示
* ブループリントの追加
* ID別の青写真の詳細を取得
* IDによるブループリントの削除
* IDの青写真の詳細を更新
* 青写真のVMの取得
* ブループリントに含まれるVMの電源ステータスの取得
* ブループリントカウントの取得
* すべての青写真の詳細を確認


*コンプライアンス*

APIを使用して追加処理と取得処理を実行

* 青写真のコンプライアンスチェック結果を取得
* 青写真のコンプライアンスチェックの最終ステータスを取得
* 青写真の新しいコンプライアンスチェックをオンデマンドで追加


*実行*

APIを使用してGET処理を実行する

* 実行の詳細をすべて取得
* 実行中の詳細を取得
* 実行回数の取得
* 実行中の実行数を取得
* 実行IDのステップを取得


*リカバリ*

APIを使用して追加処理と取得処理を実行

* ブループリントの新しい実行リクエストを追加する
* ブループリントの実行の再試行要求を追加
* すべてのブループリントの実行ステータスを取得する
* Blueprint IDの実行ステータスを取得します。


*スクリプトブロック*

APIを使用してGET処理と更新処理を実行

* すべてのスクリプトメタデータを取得
* IDによるスクリプトメタデータの取得
* すべての更新メタデータを取得
* スクリプトの実行




=== スクリプトブロック

In Shiftツールキット内のスクリプトブロックには、内部および外部APIを使用して機能を自動化、統合、開発するのに役立つサンプルコードが用意されています。スクリプトブロックのコードサンプルセクションで、Shift Toolkit Automationチームとコミュニティメンバーによって作成されたサンプルを参照してダウンロードします。サンプルを使用して、自動化、管理、統合タスクを開始します。

image:shift-toolkit-image81.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

ここでは、Shift UI内で特定のジョブを削除するために使用できるPowerShellスクリプトの例を示します。この機能はワークフローでは公開されませんが、スクリプトブロックを使用して実行することもできます。同じスクリプトをダウンロードして呼び出すことで簡単に実行できるbatスクリプトとしても利用できます。

image:shift-toolkit-image82.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

ここでの目的は、ShiftツールキットAPIと各ハイパーバイザーが公開するAPIを使用して、特定のハイパーバイザーに対して0日目とN日目の操作を実行するサンプルスクリプトを提供することです。



== SAN環境

Shiftツールキットの主な要件として、変換対象のVMをNAS環境（NFS for ESX）に配置する必要があります。SAN環境（iSCSI、FC、FCoE、NVMeFC）にVMがある場合は、変換前にNAS環境に移行する必要があります。

image:shift-toolkit-image83.png["入力/出力ダイアログを示す図、または書き込まれた内容を表す図"]

上記のアプローチは、VMがSANデータストアに格納される一般的なSAN環境を示しています。ESXからHyper-Vに変換するVMとそのディスクは、まずVMware vSphere Storage vMotionを使用してNFSデータストアに移行されます。Shift Toolkitでは、FlexCloneを使用してVMをESXからHyper-Vに変換します。変換されたVMとそのディスクは、CIFS共有に存在します。変換されたVMとそのディスクは、Hyper-Vストレージライブマイグレーションを使用して、SAN対応のCSVに移行されます。


NOTE: ノードのプロセス機能セットが異なると、VMのライブ移行が失敗することがあります。これは、「別のプロセッサを搭載した物理コンピュータに移行する」を設定することで処理できます。このスクリプトは、scriptブロックの下にあります。
