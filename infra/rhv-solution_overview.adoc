---
sidebar: sidebar 
permalink: infra/rhv-solution_overview.html 
keywords: NVA-1148, HCI, Design, hyperconverged infrastructure, best practices, Element, QoS, RHV, Red Hat, virtualization 
summary:  
---
= NVA-1148 ： NetApp HCI with Red Hat Virtualization
:hardbreaks:
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/


ネットアップ、 Alan Cowles 、 Nikhil M Kulkarni 氏

NetApp HCI with Red Hat Virtualization は、信頼性の高い方法でオンプレミスの仮想データセンター環境を導入するための、検証済みのベストプラクティスアーキテクチャです。

このアーキテクチャリファレンスドキュメントは、設計ガイドとしても、 NetApp HCI 上の Red Hat Virtualization 解決策の導入検証としても使用できます。本ドキュメントで説明しているアーキテクチャは、ネットアップと Red Hat のエキスパートによって検証されたものであり、お客様の社内データセンター環境で NetApp HCI を使用してエンタープライズ仮想データセンターを導入する際のベストプラクティスとして利用できます。



=== ユースケース

Red Hat Virtualization 解決策上の NetApp HCI for Red Hat OpenShift は、次のユースケースでお客様に卓越した価値を提供するように設計されています。

. NetApp HCI でオンデマンドで拡張できるインフラ
. Red Hat Virtualization におけるエンタープライズ仮想ワークロード




=== NetApp HCI と Red Hat の価値提案と差別化 仮想化

この仮想インフラ解決策には、 NetApp HCI が次のようなメリットがあります。

* コンピューティングとストレージを個別に拡張できる分離型アーキテクチャ。
* 独立した NetApp HCI ストレージノードで仮想化のライセンスコストやパフォーマンスへの影響がゼロになりました。
* NetApp Element ストレージは、ストレージボリュームごとに Quality of Service （ QoS ；サービス品質）を提供し、 NetApp HCI 上のワークロードのストレージパフォーマンスを保証して、隣接するワークロードがパフォーマンスに悪影響を与えないようにします。
* ネットアップのデータファブリックを使用すると、オンプレミスからオンプレミスの場所にデータをレプリケートしたり、クラウドにレプリケートしたりして、データが必要な場所にデータを移動することができます。
* ネットアップサポートまたは Red Hat サポートによるサポート。




=== NetApp HCI デザイン

NetApp HCI は、業界初の分離型ハイブリッドクラウドインフラであり、広く認められているハイパーコンバージドソリューションのメリットを提供します。TCO の削減、仮想化ワークロードの導入、導入、管理の容易さなどのメリットがあります。また、企業のお客様は、コンピューティングリソースとストレージリソースを必要に応じて個別に拡張できます。NetApp HCI と Red Hat Virtualization は、 Red Hat Enterprise Linux をベースとしたオープンソースのエンタープライズ仮想化環境を提供します。

NetApp HCI は、即応性に優れたターンキーインフラプラットフォームを提供することで、エンタープライズクラスの仮想化およびコンテナ化されたワークロードを迅速に実行できます。NetApp HCI は、中核的な機能として、予測可能なパフォーマンス、コンピューティングリソースとストレージリソースのリニアな拡張性、シンプルな導入と管理を実現します。



==== 予測性

マルチテナント環境における最大の課題の 1 つは、すべてのワークロードに対して予測可能な一貫したパフォーマンスを提供することです。複数のエンタープライズクラスのワークロードを実行すると、リソースの競合が発生し、 1 つのワークロードが別のワークロードのパフォーマンスを妨げます。NetApp HCI は、 NetApp Element ソフトウェアに標準で搭載されているストレージの QoS （サービス品質）制限に関するこの問題を軽減します。Element を使用すると、すべてのアプリケーションとボリュームをきめ細かく制御でき、ノイジーネイバーの排除や、エンタープライズクラスのパフォーマンス SLA の達成に役立ちます。NetApp HCI のマルチテナンシー機能は、パフォーマンスに関する従来の問題の多くを解消するのに役立ちます。



==== 柔軟性

旧世代のハイパーコンバージドインフラには、通常、固定のリソース比率が必要で、導入できるノード数は 4 ノード構成と 8 ノード構成に制限されていました。NetApp HCI は分離型ハイパーコンバージドインフラで、コンピューティングリソースとストレージリソースを個別に拡張できます。個別に拡張できるため、コストのかかる非効率的なオーバープロビジョニングが回避され、コントローラ仮想マシン（ VM ）のオーバーヘッドによる HCI の無駄なコストが 10~30% 削減され、容量やパフォーマンスの計画が簡単になります。NetApp HCI は、小規模、中規模、大規模のストレージとコンピューティングを組み合わせた構成が可能です。

アーキテクチャ設計の選択肢によって、ニーズに合わせて確実に拡張できるため、コアティア 1 データセンターのアプリケーションやプラットフォームにも HCI を活用できます。NetApp HCI は、シャーシまたはノードレベルのビルディングブロックで構築されています。各シャーシは、ストレージノードとコンピューティングノードを混在させる構成で 4 つのノードを保持できます。



==== シンプル

IT コミュニティでは、導入の簡易化と日常業務の自動化が推進されています。このため、ユーザミスのリスクを排除しつつ、より興味深い価値の高いプロジェクトにリソースを解放することが重要になります。NetApp HCI は、導入と継続的管理を簡易化することで、 IT 部門の即応性と対応力を高めます。



=== ビジネスバリュー

Red Hat 製品を使用してオープンソースのデータセンターで仮想化を実行する企業は、本ドキュメントで説明する設計、導入、ベストプラクティスに従うことで、この解決策の価値を実現できます。NetApp HCI で RHV を詳細に設定することで、エンタープライズ仮想化解決策の一部として導入することで、次のようなメリットが得られます。

* スタックのすべてのレイヤで高可用性を実現します
* 導入手順を徹底的に文書化
* ハイパーバイザーやマネージャ VM のノンストップオペレーションとアップグレードが可能
* 管理を容易にする API ベースのプログラム可能なインフラ
* パフォーマンスを保証するマルチテナンシー
* KVM に基づいて仮想ワークロードを実行する機能 エンタープライズクラスの機能とサポート
* ワークロードのニーズに応じてインフラを個別に拡張できること


NetApp HCI と Red Hat の仮想化ソリューションを使用すると、これらの課題に対応し、解決策の導入に検証済みアーキテクチャを実装することで各問題に対処できます。



=== テクノロジの概要

NetApp HCI for Red Hat Virtualization では、完全に統合された本番環境レベルの仮想データセンターを導入して、次の機能を利用できます。

* NetApp HCI のコンピューティングノードとストレージノード
+
** ハイブリッドクラウドワークロード向けに設計された、エンタープライズクラスのハイパーコンバージドインフラ
** NetApp Element ストレージソフトウェア
** NVIDIA GPU のオプションを含む、 Intel ベースのサーバコンピューティングノード


* Red Hat 仮想化
+
** 仮想インフラの導入と管理に使用するエンタープライズハイパーバイザー解決策です






==== NetApp HCI

NetApp HCI は、エンタープライズ規模で自由度の高いハイブリッドクラウドインフラ（ HCI ）解決策です。即応性、拡張性、管理性に優れた 2 ラックユニット（ 2RU ）の 4 ノードビルディングブロックに、コンピューティングリソースとストレージリソースを提供します。また、 1RU のコンピューティングノードとサーバノードで構成することもできます。最小の導入は、 4 つの NetApp HCI ストレージノードと 2 つの NetApp HCI コンピューティングノードで構成されます。コンピューティングノードは、 HA クラスタで RHV - H ハイパーバイザーとしてインストールされます。この最小構成は、 NetApp HCI ストレージノードやコンピューティングノードを追加して利用可能なリソースを拡張することで、お客様のエンタープライズワークロードのニーズに合わせて簡単に拡張できます。

image:redhat_virtualization_image1.png["エラー：グラフィックイメージがありません"]

NetApp HCI for Red Hat Virtualization の設計は、最小構成で次のコンポーネントで構成されています。

* NetApp Element ソフトウェアを実行する NetApp H シリーズオールフラッシュストレージノード
* Red Hat Virtualization RHV-H を実行する NetApp H シリーズコンピューティングノード ハイパーバイザー


NetApp HCI のコンピューティングノードとストレージノードの詳細については、を参照してください https://www.netapp.com/us/media/ds-3881.pdf["NetApp HCI データシート"^]。



==== NetApp Element ソフトウェア

NetApp Element ソフトウェアは、拡張性に優れたモジュラ型のパフォーマンスを提供し、ストレージノードごとに容量とスループットを保証します。ボリュームごとのストレージ QoS ポリシーを指定して、要件がきわめて厳しいワークロードにも専用のパフォーマンスレベルをサポートすることもできます。



===== iSCSI ログインのリダイレクトと自己回復機能

NetApp Element ソフトウェアは、 iSCSI ストレージプロトコルを使用します。これは、従来の TCP/IP ネットワークに SCSI コマンドをカプセル化する標準的な方法です。SCSI 標準が変更された場合や、イーサネットネットワークのパフォーマンスが向上した場合、 iSCSI ストレージプロトコルには変更を加える必要がありません。

すべてのストレージノードには管理 IP とストレージ IP が設定されますが、 NetApp Element ソフトウェアは、クラスタ内のすべてのストレージトラフィックについて、ストレージ仮想 IP アドレス（ SVIP アドレス）を 1 つアドバタイズします。iSCSI のログインプロセスでは、ストレージはターゲットボリュームが別のアドレスに移動されたことを応答するため、ネゴシエーションプロセスを続行できません。その後、ホスト側の再設定を必要としないプロセスで、ホストはログイン要求を新しいアドレスに再発行します。このプロセスは、 iSCSI ログインリダイレクトと呼ばれます。

iSCSI ログインリダイレクトは、 NetApp Element ソフトウェアクラスタの重要な要素です。ホストログイン要求を受信すると、ノードは、 IOPS とボリュームの容量要件に基づいて、トラフィックを処理するクラスタのメンバーを決定します。ボリュームは NetApp Element ソフトウェアクラスタ全体に分散され、単一のノードがボリュームのトラフィックを大量に処理している場合や新しいノードが追加された場合に再配置されます。特定のボリュームの複数のコピーがアレイ全体に割り当てられます。この方法では、ノード障害のあとにボリュームの再配分が発生しても、ログアウトして新しい場所にリダイレクトしてログインした場合を超えてホスト接続には影響はありません。iSCSI ログインリダイレクションを使用する NetApp Element ソフトウェアクラスタは、無停止のアップグレードと運用が可能な自己回復型のスケールアウトアーキテクチャです。



===== NetApp Element ソフトウェアクラスタの QoS

NetApp Element ソフトウェアクラスタでは、 QoS をボリューム単位で動的に設定できます。ボリュームごとの QoS 設定を使用して、定義した SLA に基づいてストレージパフォーマンスを制御できます。QoS は、次の 3 つの設定可能なパラメータで定義されます。

* * 最小 IOPS 。 * NetApp Element ソフトウェアクラスタがボリュームに提供する平常時の最小 IOPS 。ボリュームに設定された最小 IOPS は、そのボリュームに対して最低限保証されるパフォーマンスレベルです。ボリュームごとのパフォーマンスがこのレベルを下回ることはありません。
* * 最大 IOPS 。 * NetApp Element ソフトウェアクラスタが特定のボリュームに提供する平常時の最大 IOPS 。
* * Burst IOPS 。 * 短時間のバースト時に許容される最大 IOPS 。バースト期間の設定は、デフォルトの 1 分に設定できます。ボリュームが最大 IOPS レベル未満で動作しているときは、バーストクレジットが蓄積されます。パフォーマンスレベルが非常に高くなってプッシュされると、ボリュームで IOPS が最大 IOPS を超えた短時間のバーストが許容されます。




===== マルチテナンシー

セキュアマルチテナンシーには、次の機能があります。

* * セキュアな認証。 * Challenge Handshake Authentication Protocol （ CHAP ；チャレンジハンドシェイク認証プロトコル）は、ボリュームへのセキュアなアクセスに使用されます。Lightweight Directory Access Protocol （ LDAP ）は、管理とレポートのためのクラスタへのセキュアなアクセスに使用されます。
* * ボリュームアクセスグループ（ VAG ）。 * 必要に応じて、任意の数の iSCSI イニシエータ固有の iSCSI Qualified Name （ IQN ）を 1 つ以上のボリュームにマッピングし、認証の代わりに VAG を使用できます。VAG 内のボリュームにアクセスするには、イニシエータの IQN がボリュームグループの許可された IQN リストに含まれている必要があります。
* * テナント仮想 LAN （ VLAN ）。 * ネットワークレベルでは、 iSCSI イニシエータと NetApp Element ソフトウェアクラスタ間のエンドツーエンドのネットワークセキュリティは、 VLAN を使用することで容易になります。ワークロードやテナントを分離するために作成された VLAN については、 Element ソフトウェアが特定の VLAN 経由でのみアクセス可能な iSCSI ターゲット SVIP アドレスを別途作成します。
* * VPN ルーティング / 転送（ VRF ）対応 VLAN 。 * データセンターのセキュリティと拡張性をさらにサポートするため、 Element ソフトウェアを使用すると、 VRF に似た機能を持つテナント VLAN を有効にできます。この機能には、次の 2 つの主要機能が追加されて
+
** * テナント SVIP アドレスへの L3 ルーティング。 * この機能を使用すると、 iSCSI イニシエータを、 NetApp Element ソフトウェアクラスタとは別のネットワークまたは VLAN に配置できます。
** * IP サブネットの重複または重複 * 。この機能を使用すると、テナント環境にテンプレートを追加し、各テナント VLAN に同じ IP サブネットから IP アドレスを割り当てることができます。この機能は、 IP スペースの拡張と保持が重要なサービスプロバイダ環境に役立ちます。






===== エンタープライズクラスのストレージ効率化

NetApp Element ソフトウェアクラスタを使用すると、全体的なストレージ効率とパフォーマンスが向上します。次の機能はインラインで実行されます。常時有効であり、ユーザによる手動設定は必要ありません。

* * 重複排除。 * システムには、一意の 4K ブロックのみが保存されます。重複する 4K ブロックは格納済みのデータバージョンに自動的に関連付けられます。データはブロックドライブに格納され、 Element Helix データ保護でミラーリングされます。このシステムは、システム内の容量消費と書き込み処理数を大幅に削減します。
* * 圧縮。 * 圧縮は、データが NVRAM に書き込まれる前にインラインで実行されます。データは 4K ブロック単位で圧縮され、システム内で圧縮されたままとなります。この圧縮により、クラスタ全体での容量消費、書き込み処理数、および帯域幅消費が大幅に削減されます。
* * シンプロビジョニング。 * この機能は、必要なときに必要な量のストレージを提供し、オーバープロビジョニングされたボリュームや利用率の低いボリュームによる容量消費を排除します。
* * Helix 。 * 個々のボリュームのメタデータはメタデータドライブに格納され、セカンダリメタデータドライブにレプリケートされて冗長性が確保されます。



NOTE: Element は自動化を目的として設計されました。上記のストレージ機能はすべて API で管理できます。これらの API は、 UI がシステムを制御するために使用する唯一の方法であり、解決策の管理を容易にするためにユーザワークフローに組み込むことができます。



==== Red Hat 仮想化

Red Hat Virtualization （ RHV ）は、 KVM ハイパーバイザーを使用する Red Hat Enterprise Linux で実行されるエンタープライズ仮想データセンタープラットフォームです。

Red Hat Virtualization の詳細については、の Web サイトを参照してください https://www.redhat.com/en/technologies/virtualization/enterprise-virtualization["こちらをご覧ください"^]。

RHV は以下の機能を提供します。

* * 仮想マシンとホストの一元管理。 * RHV マネージャは、導入環境の物理または仮想マシンとして動作し、中央インターフェイスから解決策を管理するための Web ベースの GUI を提供します。
* * 自己ホスト型エンジン。 * ハードウェア要件を最小限に抑えるため、 RHV を使用することで、ゲスト VM を実行するホスト上の VM として RHV マネージャを導入できます。
* * 高可用性。 * ホスト障害による中断を避けるため、 RHV を使用することで、 VM を高可用性に設定できます。高可用性 VM は、耐障害性ポリシーを使用してクラスタレベルで制御されます。
* * 高い拡張性。 * 1 つの RHV クラスタで最大 200 台のハイパーバイザホストを構成できるため、 IT 部門は大量のリソースを消費するエンタープライズクラスのワークロードを保持する大規模な VM の要件に対応できます。
* * セキュリティの強化。 * RHEL 、 Secure Virtualization （ sVirt ）、 Security Enhanced Linux （ SELinux ）テクノロジーから継承されたものは、セキュリティの強化とホストおよび VM の強化を目的として RHV によって採用されています。これらの機能の主なメリットは、 VM とそれに関連するリソースを論理的に分離できることです。




===== Red Hat Virtualization Manager の略

Red Hat Virtualization Manager （ RHV - M ）は、 RHV 仮想環境内の物理リソースと論理リソースに対して、一元的なエンタープライズクラスの管理を提供します。RHV-M 機能にアクセスするために、異なるロールベースポータルを持つ Web ベースの GUI が提供されます。

RHV-M は、オープンソースのコミュニティベースの RESTful API を使用して RHV リソースの構成と管理を公開します。また、 Red Hat CloudForms や Red Hat Ansible による自動化やオーケストレーションなどの本格的な統合もサポートしています。



===== Red Hat Virtualization ホスト

ホスト（ハイパーバイザー）は、 VM を実行するためのハードウェアリソースを提供する物理サーバです。Kernel-based Virtual Machine （ KVM ）は完全な仮想化サポートを提供し、 Virtual Desktop Server Manager （ VDSM ）は RHV-M とのホスト通信を担当するホストエージェントです

Red Hat Virtualization でサポートされるホストには、 Red Hat Virtualization Hosts （ RHV-H ）と Red Hat Enterprise Linux ホスト（ RHEL ）の 2 種類があります。

RHV-H は、 RHV ハイパーバイザとしての物理サーバのセットアップを容易にするために最適化された、 Red Hat Enterprise Linux ベースの最小限の軽量オペレーティングシステムです。

RHEL ホストは、 Red Hat Enterprise Linux の標準オペレーティングシステムを実行するサーバです。その後、必要なサブスクリプションを設定して、物理サーバを RHV ホストとして使用するために必要なパッケージをインストールできます。



===== Red Hat の仮想化アーキテクチャ

Red Hat Virtualization は、 2 つの異なるアーキテクチャに導入できます。 RHV-M はインフラストラクチャ内の物理サーバとして、または RHV-M は自己ホスト型エンジンとして構成されます。このガイドのように、自己ホスト型エンジン環境を使用することを推奨します。この環境では、 RHV - M は他の VM と同じ環境でホストされる VM です。

ゲスト VM と RHV - M の高可用性を実現するには、少なくとも 2 つの自己ホストノードが必要ですマネージャ VM に高可用性を提供するために、 HA サービスが有効になり、すべての自己ホスト型エンジンノードで実行されます。

image:redhat_virtualization_image2.png["エラー：グラフィックイメージがありません"]

link:rhv-architecture_overview.html["次の手順：アーキテクチャの概要"]
