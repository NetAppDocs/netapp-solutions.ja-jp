---
sidebar: sidebar 
permalink: infra/hcicaci_architecture.html 
keywords: StorageGRID, QoS, Cisco ACI Virtual Edge, AVE, VMware distributed switch, VDS, Linux bridge, open vswitch, software, hardware, NetApp Hybrid Cloud Control, performance, interoperability, 
summary: TR-4857 
---
= アーキテクチャ
:hardbreaks:
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/




== 解決策テクノロジ

このドキュメントでは、 NetApp HCI と Cisco ACI の連携を通じて、フル機能のオンプレミスデータセンターやプライベートクラウドを実現するためのベストプラクティスについて説明します。ワークロードに独立していることを証明するため、ネットワーキングのベストプラクティスは、 NetApp HCI 経由で導入される VMware vSphere や Red Hat Virtualization などの仮想化ソリューションや、 NetApp ONTAP や StorageGRID などの他のストレージソリューションにも適用されます。また、 VMware Distributed Switch （ VDS ）、 Cisco ACI Virtual Edge （ AVE ）、 Linux Bridge 、 Open vSwitch など、異なる仮想スイッチを使用する Cisco ACI スイッチの相互運用性についても強調しています。



== NetApp HCI

NetApp HCI は、エンタープライズ対応のハイパーコンバージドインフラ解決策です。即応性、拡張性、管理性に優れたアーキテクチャに、コンピューティングリソースとストレージリソースを提供します。複数のエンタープライズクラスのワークロードを実行すると、リソースの競合が発生し、 1 つのワークロードが別のワークロードのパフォーマンスを妨げます。NetApp HCI は、 NetApp Element ソフトウェアに標準で搭載されているストレージの QoS （サービス品質）制限に関するこの問題を軽減します。Element を使用すると、すべてのアプリケーションとボリュームをきめ細かく制御でき、ノイジーネイバーの排除や、エンタープライズクラスのパフォーマンス SLA の達成に役立ちます。NetApp HCI のマルチテナンシー機能は、従来のパフォーマンス関連の問題の多くを解消するのに役立ちます。NetApp HCI の概要については、次の図を参照してください。

image:hcicaci_image1.png["エラー：グラフィックイメージがありません"]

NetApp HCI では、導入プロセスを合理化するために、わかりやすい UI の導入エンジンである NetApp Deployment Engine （ NDE ）を使用します。このエンジンによって、 400 以上の入力項目が 30 未満に自動化され、約 45 分でセットアップを実行できます。さらに、強力な API スイートにより、管理、オーケストレーション、バックアップ、ディザスタリカバリの高度なツールとシームレスに統合できます。NetApp Hybrid Cloud Control 管理スイートを使用すると、単一のコンソールでインフラ全体の管理、監視、アップグレードをライフサイクル全体で実行できます。



=== Software-Defined Architecture の略

NetApp HCI は、データとストレージリソースの導入と管理を行う Software-Defined アプローチを提供します。NetApp HCI では、 NetApp Element ソフトウェアを使用して、ストレージの自動化、設定、管理を行うための使いやすい GUI ベースのポータルと REST ベースの API を提供しています。NetApp Element ソフトウェアは、各ストレージノードが環境に保証された容量とスループットを提供することで、拡張性に優れたモジュラ型のパフォーマンスを実現します。

NetApp HCI では、 NetApp Deployment Engine （ NDE ）を使用して、 VMware vSphere 環境のインストールと設定、 NetApp Element Plug-in for vCenter Server の統合など、物理インフラの設定と導入を自動化しています。次の図は、 NetApp HCI を導入するプロセスの概要を示しています。

image:hcicaci_image2.png["エラー：グラフィックイメージがありません"]



=== パフォーマンス保証

共通の課題は、複数のアプリケーションが同じインフラを共有している場合に予測可能なパフォーマンスを提供することです。他のアプリケーションに影響を及ぼすアプリケーションがあると、パフォーマンスが低下します。メインストリーム・アプリケーションには固有の I/O パターンがあり ' 共有環境に導入されると ' 相互のパフォーマンスに影響を与える可能性がありますこのような問題に対応するために、 NetApp HCI の Quality of Service （ QoS ；サービス品質）機能を使用すると、すべてのアプリケーションのパフォーマンスをきめ細かく制御できるため、ノイジーネイバーが排除され、パフォーマンス SLA を満たすことができます。NetApp HCI では、最小 IOPS 、最大 IOPS 、バースト時の IOPS の値が各ボリュームに設定されます。最小 IOPS の設定は、システム上の他のアプリケーションが何を実行するかに関係なく、パフォーマンスを保証します。最大 IOPS とバースト時の IOPS の値は割り当てを制御するため、システムはすべてのワークロードに一貫したパフォーマンスを提供できます。

NetApp Element ソフトウェアは、 iSCSI ストレージプロトコルを使用します。これは、従来の TCP/IP ネットワークに SCSI コマンドをカプセル化する標準的な方法です。Element では、パフォーマンスを向上させるために、 iSCSI ログインリダイレクトという手法を使用します。iSCSI ログインリダイレクトは、 NetApp Element ソフトウェアクラスタの重要な要素です。ホストログイン要求を受信すると、ノードは、 IOPS とボリュームの容量要件に基づいて、トラフィックを処理するクラスタのメンバーを決定します。ボリュームは NetApp Element ソフトウェアクラスタ全体に分散され、単一のノードがボリュームのトラフィックを大量に処理している場合や新しいノードが追加された場合に再配置されます。特定のボリュームの複数のコピーがアレイ全体に割り当てられます。この方法では、ノード障害のあとにボリュームの再配分が発生しても、ログアウトして新しい場所にリダイレクトしてログインした場合を超えてホスト接続には影響はありません。iSCSI ログインリダイレクションを使用する NetApp Element ソフトウェアクラスタは、無停止アップグレードと運用が可能な自己回復型スケールアウトアーキテクチャです。



=== 相互運用性

旧世代のハイパーコンバージドインフラには、通常、固定のリソース比率が必要で、導入できるノード数は 4 ノード構成と 8 ノード構成に制限されていました。NetApp HCI は分離型ハイパーコンバージドインフラで、コンピューティングリソースとストレージリソースを個別に拡張できます。非効率でコストが高くつくオーバープロビジョニングを避けられるので、容量やパフォーマンスの計画を立てやすくなります。

アーキテクチャ設計の選択肢によって、ニーズに合わせて確実に拡張できるため、コアティア 1 データセンターのアプリケーションやプラットフォームにも HCI を活用できます。シャーシまたはノードレベルのビルディングブロックで構築されています。各シャーシは、ストレージノードとコンピューティングノードを混在させる構成で 4 つのノードを保持できます。NetApp HCI は、小規模、中規模、大規模のストレージとコンピューティングを組み合わせた構成が可能です。

NetApp HCI は、エンタープライズクラスの機能を備えた、実績のあるマルチプロトコルとハイブリッドクラウドのサポートを提供します。また、複数の異なるホスト仮想化テクノロジやストレージソリューションとの相互運用性も容易に実現します。アプライアンスとして ONTAP Select と StorageGRID を導入すると、 NetApp HCI のストレージ機能が拡張されて、ファイル、ブロック、オブジェクトストレージの各サービスを利用できるようになります。NetApp HCI は、さまざまなフレーバーを持つ仮想データセンター向けのアジャイルインフラプラットフォームを提供します。VMware vSphere 、 Red Hat Virtualization 、 KVM 、 Citrix ハイパーバイザーなどがサポートされているプラットフォームで、 NetApp HCI インフラを使用して、エンタープライズクラスの拡張性に優れたオンプレミス仮想環境を実現できます。

詳細については、を参照してください https://docs.netapp.com/hci/index.jsp["NetApp HCI のドキュメント"^]。



== Cisco ACI

Cisco ACI は、アプリケーションの即応性とデータセンターの自動化を促進する、業界をリードするソフトウェア定義型ネットワーク解決策です。Cisco ACI は、一元化されたポリシーベースの管理機能を備えた包括的なアーキテクチャを提供します。プログラム可能なデータセンターの Virtual Extensible LAN （ VXLAN ）ファブリックを実装し、仮想、物理、コンテナなどの特性に関係なく、あらゆるワークロードに分散ネットワークとセキュリティを提供します。

Cisco ACI は、データセンターにインテントベースのネットワーキングを導入した他社製品です。この製品は、オーバーレイと集中管理の 2 つの重要な SDN 機能と統合された高性能ハードウェアと堅牢なソフトウェアを組み合わせています。ACI ファブリックは、 ACI モードで実行される Cisco Nexus 9000 シリーズスイッチと、 3 台以上の中央管理型 Application Policy Infrastructure Controller （ APIC ；アプリケーションポリシーインフラコントローラ）サーバで構成されます。次の図に、 Cisco ACI の概要を示します。

image:hcicaci_image3.jpg["エラー：グラフィックイメージがありません"]



=== ポリシーベースのネットワーク

Cisco ACI は、ポリシーベースのモデルを採用しており、ネットワークハードウェアをステートレスにしています。Application Policy Infrastructure Controller （ APIC ；アプリケーションポリシーインフラコントローラ）は、 ACI ファブリックのすべてのスイッチを管理および設定する中央コントローラとして機能します。Cisco ACI ファブリックは、宣言型ポリシーモデルを使用して APIC のクラスタによって一元的に設定および管理される Cisco Nexus 9000 シリーズスイッチで構成されます。

Cisco ACI は、論理構造を使用して階層型ポリシーアーキテクチャを形成し、インフラストラクチャ、認証、セキュリティ、サービスなど、ファブリック全体のさまざまな機能を定義および管理します。 アプリケーション、診断。

次の図は、 Cisco ACI のさまざまな論理構成要素間の分類と関係を示しています。

image:hcicaci_image4.jpeg["エラー：グラフィックイメージがありません"]

テナントは、ドメインベースのアクセス制御を実行する管理上の境界を持つ論理コンテナです。これは論理的なポリシーの分離であり、実際のネットワーク構造には相当しません。

テナント内では、コンテキストは一意のレイヤ 3 転送ポリシードメインです。コンテキストは、従来のネットワークの Virtual Routing and Forwarding （ VRF ；仮想ルーティング転送）概念に直接マッピングできます。実際、コンテキストは VRF とも呼ばれます。各コンテキストは個別のレイヤ 3 ドメインであるため、 2 つの異なるコンテキストには、 IP スペースが重複している可能性があります。

コンテキスト内では、ブリッジドメイン（ BD ）は一意のレイヤ 2 転送構造を表します。ブリッジドメインは、一意のレイヤ 2 MAC アドレススペースを定義し、レイヤ 2 フラッドドメインまたはレイヤ 3 ゲートウェイと均等にすることができます。ブリッジドメインにはゼロのサブネットを含めることができますが、 BD に存在するホストのルーティングを実行する場合は、少なくとも 1 つのサブネットが必要です。

ACI では、エンドポイントとはネットワーク上で通信するもので、コンピューティングホスト、ストレージデバイス、 ACI ファブリックに含まれないネットワークエンティティ、 VM などです。同じポリシー要件を持つエンドポイントのグループは、エンドポイントグループ（ EPG ）に分類されます。EPG は、複数のエンドポイントをまとめて設定および管理するために使用されます。EPG はブリッジドメインのメンバーです。1 つの EPG を複数のブリッジドメインのメンバーにすることはできませんが、複数の EPG を 1 つのブリッジドメインのメンバーにすることはできます。

同じ EPG に属するすべてのエンドポイントは相互に通信できます。ただし、異なる EPG 内のエンドポイントはデフォルトで通信できませんが、 2 つの EPG 間に契約が存在し、その通信が許可されている場合は通信できます。従来のネットワーキングの ACL と契約を一致させることができます。ただし、 ACL とは異なり、特定の IP アドレスを送信元および宛先として指定する必要がなく、契約が EPG 全体に適用されるという点です。

を参照してください https://www.cisco.com/c/en/us/solutions/data-center-virtualization/application-centric-infrastructure/index.html["Cisco ACI のドキュメント"^] を参照してください。



=== ネットワークの利点

Cisco ACI は、従来のネットワークに比べて多くのメリットを提供します。プログラミング性と自動化は、拡張性に優れたデータセンター仮想化インフラの重要な機能であり、 Cisco ACI のポリシーベースのメカニズムによって、最適な物理ネットワークと仮想ネットワークを提供する多くの機会が得られます。

* * Virtual Machine Manager （ VMM ）の統合。 * Cisco ACI のオープン REST API 機能により、仮想環境との統合が容易になります。Cisco ACI は、複数のハイパーバイザーとの VMM 統合をサポートし、ハイパーバイザーの仮想スイッチに対する自動アクセスと制御を ACI のネットワーク構成に提供します。ACI での VMM 統合は、 ACI ポリシーフレームワークを仮想ワークロードにシームレスに拡張します。つまり、 VMM の統合により、 Cisco ACI は仮想ホストで実行される仮想スイッチを制御し、 ACI ファブリックのアクセスポリシーを仮想ワークロードに拡張できます。また、ハイパーバイザーの仮想スイッチの導入と設定タスクも自動化されます。Cisco ACI VMM の統合により、次のようなメリットが得られます。
+
** 物理環境と仮想環境のポリシーを一元管理できます APIC を使用
** 仮想環境でアプリケーションを透過的にインスタンス化することで、アプリケーションの導入を高速化します
** を使用して、アプリケーションの健全性を完全に統合して可視化します 物理環境と仮想環境にわたる包括的な情報の集約
** VM への接続に必要なポートグループまたは VM NIC プロファイルが自動的に作成されるため、仮想ワークロードのネットワーク設定が簡易化されます。Cisco ACI VMM の統合の詳細については、を参照してください https://www.cisco.com/c/en/us/td/docs/switches/datacenter/aci/apic/sw/1-x/aci-fundamentals/b_ACI-Fundamentals/b_ACI-Fundamentals_chapter_01011.html["シスコのマニュアル"^]。さらに、 Cisco ACI を参照してください https://www.cisco.com/c/dam/en/us/td/docs/Website/datacenter/aci/virtualization/matrix/virtmatrix.html["仮想化互換性マトリックス"^] バージョンの互換性の詳細については、を参照


* * マイクロセグメンテーション。 * Cisco ACI でマイクロセグメンテーションを使用すると、既存のアプリケーション EPG のエンドポイントを、ネットワークベースまたは VM ベースの属性を使用してマイクロセグメント（ uSeg ） EPG に分類できます。これにより、エンドポイントをより細かくフィルタリングし、それらのエンドポイントに特定の動的ポリシーを適用できます。マイクロセグメンテーションは、テナント内の任意のエンドポイントに適用できます。Cisco では、 Cisco ACI Virtual Edge 、 VMware VDS 、 Microsoft vSwitch など、さまざまな仮想スイッチでマイクロセグメンテーションをサポートしています。uSeg EPG は複数の属性で設定できますが、エンドポイントを割り当てることができる EPG は 1 つだけです。詳細については、を参照してください https://www.cisco.com/c/en/us/td/docs/switches/datacenter/aci/apic/sw/3-x/virtualization/Cisco-ACI-Virtualization-Guide-3-2-x/Cisco-ACI-Virtualization-Guide-3-2-x_chapter_0100.html["Cisco ACI 仮想化ガイド"^] をクリックします。
* * Intra-EPG Isolation 。 * デフォルトでは、同じ EPG に属するすべてのエンドポイントが相互に通信できます。Cisco ACI の EPG 内分離は、同じ EPG 内のエンドポイントが互いに通信するのを防ぐ機能です。ACI リーフからハイパーバイザーホストへのトラフィックやハイパーバイザーホストから ACI リーフへのトラフィックに異なる VLAN を使用することで、分離を実現します。EPG 内分離は、アプリケーション EPG とマイクロセグメント EPG の両方に適用できます。の特定のバージョンを参照してください https://www.cisco.com/c/en/us/td/docs/switches/datacenter/aci/apic/sw/3-x/virtualization/Cisco-ACI-Virtualization-Guide-3-2-x/Cisco-ACI-Virtualization-Guide-3-2-x_chapter_0101.html["Cisco ACI 仮想化ガイド"^] を参照してください。




== アーキテクチャ図

image:hcicaci_image5.jpeg["エラー：グラフィックイメージがありません"]

この図は、この解決策向けに設計された Cisco ACI を使用した NetApp HCI の物理アーキテクチャを示しています。スパインを介して接続され、 3 つの APIC からなるクラスターによって管理される 2 つのリーフスイッチが、 ACI ファブリックを形成します。リーフスイッチは、外部接続用にアップストリームルータに接続されています。ケーブル 2 本のオプションで NetApp HCI コンピューティングノードのペアを 3 組（ハイパーバイザー専用の各ペア）構成します。4 つのストレージノードをケーブル 4 本の方法で Element クラスタに接続しました。システムに ONTAP 機能を提供するには、 AFF A200 ノードのペアを使用します。



== ハードウェアとソフトウェアの要件



=== コンピューティング

次の表に、解決策で使用されるハードウェアとソフトウェアのコンピューティングリソースを示します。解決策の実装で使用されるコンポーネントは、お客様の要件に応じて異なる場合があります。

|===
| ハードウェア | モデル | 数量 


| NetApp HCI コンピューティングノード | NetApp H410C | 6. 
|===
|===
| ソフトウェア | 目的 | バージョン 


| VMware ESXi | 仮想化 | 6.7 


| VMware vCenter Server Appliance の略 | 仮想化管理 | 6.7 


| Red Hat Enterprise Linux の場合 | オペレーティングシステム | 7.7 


| KVM の略 | 仮想化 | 1.5.3-167 


| Red Hat 仮想化 | 仮想化 | 4.3.9 
|===


=== ストレージ

次の表に、この解決策で使用されるハードウェアとソフトウェアのストレージリソースを示します。解決策の特定の実装で使用されるコンポーネントは、お客様の要件に応じて異なる場合があります。

|===
| ハードウェア | モデル | 数量 


| NetApp HCI ストレージノード | NetApp H410S | 4. 


| AFF | A200 | 2. 
|===
|===
| ソフトウェア | 目的 | バージョン 


| NetApp HCI | インフラ | 1.8 


| NetApp Element | ストレージ | 12.0 


| ONTAP | ストレージ | 9.7P6. 


| ONTAP Select の場合 | ストレージ | 9.7 


| ストレージグリッド | ストレージ | 11.3 
|===


=== ネットワーキング

次の表に、この解決策で使用されるハードウェアとソフトウェアのネットワークリソースを示します。解決策の特定の実装で使用されるコンポーネントは、お客様の要件に応じて異なる場合があります。

|===
| ハードウェア | モデル | 数量 


| Cisco UCS サーバ | UCS C-220 M3 | 3. 


| Cisco Nexus の場合 | N9K-C9336-pq | 2. 


| Cisco Nexus の場合 | N9K-C9396-PX | 2. 
|===
|===
| ソフトウェア | 目的 | バージョン 


| Cisco APIC | Network Management の略 | 3.2 （ 9 時間） 


| Cisco Nexus ACI モードスイッチ | ネットワーク | 13.2 （ 9h ） 


| Cisco AVE | ネットワーク | 1.2.9 


| Open vSwitch （ OVS ） | ネットワーク | 2.9.2 


| VMware Virtual Distributed Switch の 1 つ | ネットワーク | 6.6 
|===
link:hcicaci_design_considerations.html["次：設計上の考慮事項"]
