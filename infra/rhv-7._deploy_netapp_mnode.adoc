---
sidebar: sidebar 
permalink: infra/rhv-7._deploy_netapp_mnode.html 
keywords: mnode, management node, Element, monitoring, telemetry, diagnositic tests, utilities 
summary:  
---
= 7. ネットアップ管理ノードの導入： RHV 搭載 NetApp HCI
:hardbreaks:
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/


[role="lead"]
管理ノード（ mNode ）は、 Element ソフトウェアベースの 1 つ以上のストレージクラスタと同時に実行される VM です。これは、次の目的で使用されます。

* 監視や計測などのシステムサービスを提供します
* クラスタのアセットと設定の管理
* システム診断テストとユーティリティの実行
* サポートを追加するために、 NetApp ActiveIQ 用 callhome を有効にする


Red Hat Virtualization にネットアップ管理ノードをインストールするには、次の手順を実行します。

. mNode ISO をディスクとしてストレージドメインにアップロードします。[ ストレージ ]>[ ディスク ]>[ アップロード ] の順に選択し、 [ 開始 ] をクリックします。次に、イメージのアップロードをクリックし、ダウンロードした mNode ISO イメージを選択します。ストレージドメイン、アップロードを実行するホスト、およびその他の詳細を確認してください。[OK] をクリックして、イメージをドメインにアップロードします。進捗バーは、アップロードが完了し、 ISO が使用可能になったことを示します。
. Storage > Disks の順に選択して VM ディスクを作成し、 New をクリックします。mNode ディスクのサイズは 400GB 以上でなければなりませんが、シンプロビジョニングも可能です。ウィザードで、選択した名前を入力し、適切なデータセンターを選択し、適切なストレージドメインが選択されていることを確認してから、割り当てポリシーの ［ シンプロビジョニング ］ を選択し、 ［ 削除後に消去 ］ チェックボックスをオンにします。[OK] をクリックします。
+
image:redhat_virtualization_image61.png["エラー：グラフィックイメージがありません"]

. 次に、 [ 計算（ Compute ） ] > [ 仮想マシン（ Virtual Machines ） ] に移動し、 [ 新規（ NewGeneral サブタブで、適切なクラスタを選択し、任意の名前を入力して attach をクリックし、前の手順で作成したディスクを選択します。OS の下のチェックボックスをオンにして、起動可能なドライブであることを強調します。[OK] をクリックします。
+
image:redhat_virtualization_image62.png["エラー：グラフィックイメージがありません"]

. NIC1 のドロップダウンから ovirtmgmt を選択します。（ + ）記号をクリックし、 NIC 2 のドロップダウン・リストからストレージ・ネットワーク・インターフェイスを選択します。
+
image:redhat_virtualization_image63.png["エラー：グラフィックイメージがありません"]

. [ システム ] サブタブをクリックして、メモリが 12GB 以上で、仮想 CPU が 6 個以上あることを確認します。
+
image:redhat_virtualization_image64.png["エラー：グラフィックイメージがありません"]

. [Boot Options] サブタブをクリックし、起動シーケンスの最初のデバイスとして [CD-ROM] を選択し、 2 番目のデバイスとして [Hard Drive] を選択します。CD の接続を有効にし、 mNode ISO を接続します。[OK] をクリックします。
+
image:redhat_virtualization_image65.jpg["エラー：グラフィックイメージがありません"]

+
VM が作成されます。

. VM が使用できるようになったら、電源をオンにして、その VM へのコンソールを開きます。SolidFire mNode のインストーラのロードが開始されます。インストーラがロードされたら、 RTFI マグネシウムのインストールを開始するように求められます。「 yes 」と入力して Enter キーを押します。インストールプロセスが開始され、完了すると VM の電源が自動的にオフになります。
+
image:redhat_virtualization_image66.png["エラー：グラフィックイメージがありません"]

. 次に、 mNode VM をクリックし、 Edit をクリックします。[Boot Options] サブタブで、 [Attach CD] チェックボックスをオフにし、 [OK] ボタンをクリックします。
+
image:redhat_virtualization_image67.jpg["エラー：グラフィックイメージがありません"]

. mNode VM の電源をオンにします。ターミナルユーザインターフェイス（ TUI ）を使用して、管理ノードの管理ユーザを作成します。
+

NOTE: メニューオプションを移動するには、上矢印キーまたは下矢印キーを押します。ボタン間を移動するには、 Tab キーを押します。ボタンからフィールドに移動するには、 Tab キーを押します。フィールド間を移動するには、上矢印キーまたは下矢印キーを押します。

+
image:redhat_virtualization_image68.jpg["エラー：グラフィックイメージがありません"]

. ユーザが作成されると、ログイン画面に戻ります。作成したクレデンシャルを使用してログインします。
. 管理インターフェイスから始まるネットワークインターフェイスを設定するには、 Network > Network Config > eth0 に移動して、使用している環境の IP アドレス、ネットマスク、ゲートウェイ、 DNS サーバ、および検索ドメインを入力します。[OK] をクリックします。
+
image:redhat_virtualization_image69.jpg["エラー：グラフィックイメージがありません"]

. 次に、 eth1 を設定してストレージネットワークにアクセスします。Network > Network Config > eth1 に移動し、 IP アドレスとネットマスクを入力します。MTU が 9000 であることを確認します。[OK] をクリックします。
+
image:redhat_virtualization_image70.jpg["エラー：グラフィックイメージがありません"]

+
これで TUI インターフェイスを閉じることができます。

. 管理 IP を使用して SSH で管理ノードに接続し、 root にエスカレーションして、 mNode を HCI ストレージクラスタに登録します。
+
....
admin@SF-3D1C ~ $ sudo su

SF-3D1C /home/admin # /sf/packages/mnode/setup-mnode --mnode_admin_user admin --storage_mvip 10.63.172.140 --storage_username admin --telemetry_active true

Enter the password for storage user admin:
Enter password for mNode user admin:
[2020-05-21T17:19:53.281657Z]:[setup_mnode:296] INFO:Starting mNode deployment
[2020-05-21T17:19:53.286153Z]:[config_util:1313] INFO:No previously running mNode. Continuing with deployment.
[2020-05-21T17:19:53.286687Z]:[config_util:1320] INFO:Validating credentials for mNode host.
[2020-05-21T17:19:53.316270Z]:[config_util:1232] INFO:Checking Cluster information.
[2020-05-21T17:19:53.380168Z]:[config_util:112] INFO:Cluster credentials verification successful.
[2020-05-21T17:19:53.380665Z]:[config_util:1252] INFO:Cluster version check successful.
[2020-05-21T17:19:53.458271Z]:[config_util:112] INFO:Successfully queried system configuration
[2020-05-21T17:19:53.463611Z]:[config_util:497] INFO:CIDR range 172.16.0.0/22 open. Using for docker ingress.
[2020-05-21T17:19:53.464179Z]:[mnodecfg:141] INFO:Configuring mNode
[2020-05-21T17:19:53.464687Z]:[config_util:194] INFO:Wait for ping of 127.0.0.1 to succeed
[2020-05-21T17:19:53.475619Z]:[mnodecfg:145] INFO:Validating the supplied MNode network configuration
[2020-05-21T17:19:53.476119Z]:[mnodecfg:155] INFO:Testing the MNode network configuration
[2020-05-21T17:19:53.476687Z]:[config_util:353] INFO:Testing network connection to storage MVIP: 10.63.172.140
[2020-05-21T17:19:53.477165Z]:[config_util:194] INFO:Wait for ping of 10.63.172.140 to succeed
[2020-05-21T17:19:53.488045Z]:[config_util:356] INFO:Successfully reached storage MVIP: 10.63.172.140
[2020-05-21T17:19:53.488569Z]:[mnodecfg:158] INFO:Configuring MNode storage (this can take several minutes)
[2020-05-21T17:19:57.057435Z]:[config_util:536] INFO:Configuring MNode storage succeeded.
[2020-05-21T17:19:57.057938Z]:[config_util:445] INFO:Replacing default ingress network.
[2020-05-21T17:19:57.078685Z]:[mnodecfg:163] INFO:Extracting services tar (this can take several minutes)
[2020-05-21T17:20:36.066185Z]:[config_util:1282] INFO:Extracting services tar succeeded
[2020-05-21T17:20:36.066808Z]:[mnodecfg:166] INFO:Configuring MNode authentication
[2020-05-21T17:20:36.067950Z]:[config_util:1485] INFO:Updating element-auth configuration
[2020-05-21T17:20:41.581716Z]:[mnodecfg:169] INFO:Deploying MNode services (this can take several minutes)
[2020-05-21T17:20:41.810264Z]:[config_util:557] INFO:Deploying MNode services succeeded
[2020-05-21T17:20:41.810768Z]:[mnodecfg:172] INFO:Deploying MNode Assets
[2020-05-21T17:20:42.162081Z]:[config_util:122] INFO:Retrying 1/45 time...
[2020-05-21T17:20:42.162640Z]:[config_util:125] INFO:Waiting 10 seconds before next attempt.
[2020-05-21T17:20:52.199224Z]:[config_util:112] INFO:Mnode is up!
[2020-05-21T17:20:52.280329Z]:[config_util:112] INFO:Root asset created.
[2020-05-21T17:20:52.280859Z]:[config_util:122] INFO:Retrying 1/5 time...
[2020-05-21T17:20:52.281280Z]:[config_util:125] INFO:Waiting 10 seconds before next attempt.
[2020-05-21T17:21:02.299565Z]:[config_util:112] INFO:Successfully queried storage assets
[2020-05-21T17:21:02.696930Z]:[config_util:112] INFO:Storage asset created.
[2020-05-21T17:21:03.238455Z]:[config_util:112] INFO:Storage asset registered.
[2020-05-21T17:21:03.241966Z]:[mnodecfg:175] INFO:Attempting to set up VCP-SIOC credentials
[2020-05-21T17:21:03.242659Z]:[config_util:953] INFO:No VCP-SIOC credential given from NDE. Using default credentials for VCP-SIOC service.
[2020-05-21T17:21:03.243117Z]:[mnodecfg:185] INFO:Configuration Successfully Completed
....
. ブラウザを使用して 'https://<mNodeIP` を使用して管理ノード GUI にログインしますmNode または Hybrid Cloud Control を使用すると、 Element クラスタの拡張、監視、アップグレードを簡単に行うことができます。
+
image:redhat_virtualization_image71.jpg["エラー：グラフィックイメージがありません"]

. 右上にある 3 本の平行線をクリックし、 [ 表示（ View ） ] [ 表示（ Active IQ ） ] をクリックします。クラスタ名をフィルタリングして HCI ストレージクラスタを検索し、最新の更新をロギングしていることを確認します。


image:redhat_virtualization_image72.jpg["エラー：グラフィックイメージがありません"]

link:rhv-updating_rhv_manager_and_rhv-h_hosts.html["次の手順：ベストプラクティス - RHV マネージャと RHV-H ホストの更新"]
