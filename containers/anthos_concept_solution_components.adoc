---
sidebar: sidebar 
permalink: containers/anthos_concept_solution_components.html 
summary: 本ドキュメントで説明する解決策は、 NetApp HCI 、 VMware vSphere 、 Anthos ハイブリッドクラウド Kubernetes データセンター解決策の強固な基盤を基盤としています。 
keywords: ESXi, Vmware, vSphere, Element 
---
= 解決策コンポーネント


本ドキュメントで説明する解決策は、 NetApp HCI 、 VMware vSphere 、 Anthos ハイブリッドクラウド Kubernetes データセンター解決策の強固な基盤を基盤としています。



== NetApp HCI

NetApp HCI は、即応性に優れたターンキーインフラプラットフォームを提供することで、エンタープライズクラスの仮想化およびコンテナ化されたワークロードを迅速に実行できます。NetApp HCI は、中核的な機能として、予測可能なパフォーマンス、コンピューティングリソースとストレージリソースのリニアな拡張性、シンプルな導入と管理を実現します。

* * 予測可能。 * マルチテナント環境における最大の課題の 1 つは、すべてのワークロードに一貫した予測可能なパフォーマンスを提供することです。複数のエンタープライズクラスのワークロードを実行すると、リソースの競合が発生し、 1 つのワークロードが別のワークロードのパフォーマンスに影響する可能性があります。NetApp HCI は、 NetApp Element ソフトウェアに標準で搭載されているストレージの QoS （サービス品質）制限に関するこの問題を軽減します。Element を使用すると、すべてのアプリケーションとボリュームをきめ細かく制御でき、ノイジーネイバーの排除や、エンタープライズクラスのパフォーマンス SLA の達成に役立ちます。NetApp HCI のマルチテナンシー機能は、パフォーマンスに関する従来の問題の多くを解消するのに役立ちます。
* * 柔軟性 * 旧世代のハイパーコンバージドインフラでは、固定リソースの比率が必要になることがよくあり、導入できるノード数は 4 ノード構成と 8 ノード構成に制限されます。NetApp HCI は分離型ハイパーコンバージドインフラで、コンピューティングリソースとストレージリソースを個別に拡張できます。非効率でコストが高くつくオーバープロビジョニングを避けられるので、コントローラ VM のオーバーヘッドによる HCI への負担が 10~30% 軽減され、容量やパフォーマンスの計画を立てやすくなります。NetApp HCI は、小規模、中規模、大規模のストレージとコンピューティングを組み合わせた構成が可能です。アーキテクチャ設計の選択肢によって、ニーズに合わせて確実に拡張できるため、ティア 1 のコアデータセンターのアプリケーションやプラットフォームにも HCI を活用できます。NetApp HCI は、シャーシまたはノードレベルのビルディングブロックで構築されています。各シャーシは、ストレージノードとコンピューティングノードを混在させる構成で 4 つのノードを保持できます。
* * IT コミュニティの推進する課題は、導入の簡素化と日常的なタスクの自動化です。ユーザーエラーのリスクを排除しながら、リソースを解放して、より興味深い、より価値の高いプロジェクトに集中できるようにすることです。NetApp HCI は、導入と継続的管理を簡易化することで、 IT 部門の即応性と対応力を高めます。NetApp Deployment Engine （ NDE ）ツールを使用すると、 VMware vSphere 環境のインストールや NetApp Element Plug-in for vCenter Server の統合など、物理インフラの設定と導入を簡単に行うことができます。NDE を使用すれば、将来の拡張処理も簡単に実行できます。




=== NetApp HCI 構成

NetApp HCI は、エンタープライズ規模で自由度の高いハイブリッドクラウドインフラ（ HCI ）解決策です。即応性、拡張性、管理性に優れた 2 ラックユニット（ 2RU ）の 4 ノードビルディングブロックに、コンピューティングリソースとストレージリソースを提供します。また、 1RU のコンピューティングノードとサーバノードで構成することもできます。このガイドで言及している NetApp HCI 環境は、 4 つの NetApp HCI ストレージノードと 2 つの NetApp HCI コンピューティングノードで構成されます。コンピューティングノードは、 VMware DRS の非アフィニティルールを適用せずに、 HA クラスタ内に VMware ESXi ハイパーバイザーとしてインストールされます。この最小構成は、 NetApp HCI ストレージノードやコンピューティングノードを追加して利用可能なストレージを拡張することで、お客様のエンタープライズワークロードのニーズに合わせて簡単に拡張できます。次の図は、 NetApp HCI の最小構成を示しています。

image::netapp_hci_min_config.png[NetApp HCI 最小構成]

NetApp HCI for Anthos は、最小構成で以下のコンポーネントで構成されています。

* NetApp Element ソフトウェアを実行する NetApp H シリーズオールフラッシュストレージノード
* VMware vSphere 6.7U3 を実行している NetApp H シリーズコンピューティングノード


NetApp HCI のコンピューティングノードとストレージノードの詳細については、を参照してください https://www.netapp.com/us/media/ds-3881.pdf["NetApp HCI データシート"]。



==== NetApp Element ソフトウェア

NetApp Element ソフトウェアは、拡張性に優れたモジュラ型のパフォーマンスを提供し、ストレージノードごとに容量とスループットを保証します。ボリュームごとのストレージ QoS ポリシーを指定して、要件がきわめて厳しいワークロードにも専用のパフォーマンスレベルをサポートすることもできます。



===== iSCSI ログインのリダイレクト機能と自己回復機能

NetApp Element ソフトウェアは、 iSCSI ストレージプロトコルを使用します。これは、従来の TCP/IP ネットワークに SCSI コマンドをカプセル化する標準的な方法です。SCSI 標準が変更された場合や、イーサネットネットワークのパフォーマンスが向上した場合、 iSCSI ストレージプロトコルには変更を加える必要がありません。

すべてのストレージノードには管理 IP とストレージ IP が設定されますが、 NetApp Element ソフトウェアは、クラスタ内のすべてのストレージトラフィックについて、ストレージ仮想 IP アドレス（ SVIP アドレス）を 1 つアドバタイズします。iSCSI のログインプロセスでは、ストレージはターゲットボリュームが別のアドレスに移動されたことを応答するため、ネゴシエーションプロセスを続行できません。その後、ホスト側の再設定を必要としないプロセスで、ホストはログイン要求を新しいアドレスに再発行します。このプロセスは、 iSCSI ログインリダイレクトと呼ばれます。

iSCSI ログインリダイレクトは、 NetApp Element ソフトウェアクラスタの重要な要素です。ホストログイン要求を受信すると、ノードは、 IOPS とボリュームの容量要件に基づいて、トラフィックを処理するクラスタのメンバーを決定します。ボリュームは NetApp Element ソフトウェアクラスタ全体に分散され、単一のノードがボリュームのトラフィックを大量に処理している場合や新しいノードが追加された場合に再配置されます。特定のボリュームの複数のコピーがアレイ全体に割り当てられます。この方法では、ノード障害のあとにボリュームの再配分が発生しても、ログアウトして新しい場所にリダイレクトしてログインした場合を超えてホスト接続には影響はありません。iSCSI ログインリダイレクションを使用する NetApp Element ソフトウェアクラスタは、無停止アップグレードと運用が可能な自己回復型スケールアウトアーキテクチャです。



===== NetApp Element ソフトウェアクラスタの QoS

NetApp Element ソフトウェアクラスタでは、 QoS をボリューム単位で動的に設定できます。ボリュームごとの QoS 設定を使用して、定義した SLA に基づいてストレージパフォーマンスを制御できます。QoS は、次の 3 つの設定可能なパラメータで定義されます。

* * 最小 IOPS 。 * NetApp Element ソフトウェアクラスタがボリュームに提供する平常時の最小 IOPS 。ボリュームに設定された最小 IOPS は、そのボリュームに対して最低限保証されるパフォーマンスレベルです。ボリュームごとのパフォーマンスがこのレベルを下回ることはありません。
* * 最大 IOPS 。 * NetApp Element ソフトウェアクラスタが特定のボリュームに提供する平常時の最大 IOPS 。
* * Burst IOPS 。 * 短時間のバースト時に許容される最大 IOPS 。バースト期間の設定は、デフォルトの 1 分に設定できます。ボリュームが最大 IOPS レベル未満で動作しているときは、バーストクレジットが蓄積されます。パフォーマンスレベルが非常に高くなってプッシュされると、ボリュームで IOPS が最大 IOPS を超えた短時間のバーストが許容されます。




===== マルチテナンシー

セキュアマルチテナンシーには、次の機能があります。

* * セキュアな認証。 * Challenge Handshake Authentication Protocol （ CHAP ；チャレンジハンドシェイク認証プロトコル）は、ボリュームへのセキュアなアクセスに使用されます。Lightweight Directory Access Protocol （ LDAP ）は、管理とレポートのためのクラスタへのセキュアなアクセスに使用されます。
* * ボリュームアクセスグループ（ VAG ）。 * 必要に応じて、任意の数の iSCSI イニシエータ固有の iSCSI Qualified Name （ IQN ）を 1 つ以上のボリュームにマッピングし、認証の代わりに VAG を使用できます。VAG 内のボリュームにアクセスするには、イニシエータの IQN がボリュームグループの許可された IQN リストに含まれている必要があります。
* * テナント仮想 LAN （ VLAN ）。 * ネットワークレベルでは、 iSCSI イニシエータと NetApp Element ソフトウェアクラスタ間のエンドツーエンドのネットワークセキュリティは、 VLAN を使用することで容易になります。ワークロードまたはテナントを分離するために作成された VLAN については、 NetApp Element ソフトウェアが、特定の VLAN 経由でのみアクセス可能な iSCSI ターゲット SVIP アドレスを別途作成します。
* *VPN ルーティング / 転送（ VFR ）対応 VLAN 。 * データセンターのセキュリティとスケーラビリティをさらにサポートするため、 NetApp Element ソフトウェアを使用すると、 VRF に似た機能を持つテナント VLAN を有効にできます。この機能には、次の 2 つの主要機能が追加されて
+
** * テナント SVIP アドレスへの L3 ルーティング。 * この機能を使用すると、 iSCSI イニシエータを、 NetApp Element ソフトウェアクラスタとは別のネットワークまたは VLAN に配置できます。
** * IP サブネットの重複または重複 * 。この機能を使用すると、テナント環境にテンプレートを追加し、各テナント VLAN に同じ IP サブネットから IP アドレスを割り当てることができます。この機能は、 IP スペースの拡張と保持が重要なサービスプロバイダ環境に役立ちます。






===== エンタープライズクラスのストレージ効率化

NetApp Element ソフトウェアクラスタを使用すると、全体的なストレージ効率とパフォーマンスが向上します。次の機能はインラインで実行されます。常時有効であり、ユーザによる手動設定は必要ありません。

* * 重複排除。 * システムには、一意の 4K ブロックのみが保存されます。重複する 4K ブロックは格納済みのデータバージョンに自動的に関連付けられます。データはブロックドライブに格納され、 Element Helix データ保護を使用してミラーリングされます。このシステムは、システム内の容量消費と書き込み処理数を大幅に削減します。
* * 圧縮。 * 圧縮は、データが NVRAM に書き込まれる前にインラインで実行されます。データは 4K ブロック単位で圧縮され、システム内で圧縮されたままとなります。この圧縮により、クラスタ全体での容量消費、書き込み処理数、および帯域幅消費が大幅に削減されます。
* * シンプロビジョニング。 * この機能は、必要なときに必要な量のストレージを提供し、オーバープロビジョニングされたボリュームや利用率の低いボリュームによる容量消費を排除します。
* * Helix 。 * 個々のボリュームのメタデータはメタデータドライブに格納され、セカンダリメタデータドライブにレプリケートされて冗長性が確保されます。


* 注： * Element は自動化を目的として設計されています。上記のストレージ機能はすべて API で管理できます。これらの API は、 Element から直接アクションを実行するか、 Element 用の vSphere プラグインを介してアクションを実行するかをシステムで制御するために UI で使用される唯一の方法です。



== VMware vSphere の場合

VMware vSphere は、 VMware ESXi ハイパーバイザー上に構築され、 vCenter Server によって管理される、業界をリードする仮想化解決策です。 vCenter Server は、企業のデータセンターによく必要な高度な機能を提供します。NetApp HCI で NDE を使用する場合は、 VMware vSphere 環境が設定およびインストールされます。環境の導入後、次の機能を使用できます。

* * 一元管理。 * vSphere を使用すると、個々のハイパーバイザをデータセンターにグループ化し、複数のクラスタにまとめることができるため、高度な組織ではリソースの全体的な管理が容易になります。
* * VMware HA 。 * この機能を使用すると、仮想ゲストはホストが使用できなくなった場合に自動的に再起動できます。この機能を有効にすると、仮想ゲストはフォールトトレラントになり、環境内に物理的な障害が発生した場合のシステム停止を最小限に抑えることができます。
* * VMware DRS （ Distributed Resource Scheduler ）。 * VMware VMotion を使用すると、特定のユーザー定義のしきい値を満たしている場合に、ホスト間でゲストを無停止で移動できます。この機能により、環境内の仮想ゲストの可用性が向上します。
* * vSphere Distributed Switch （ vDS ）。 * 仮想スイッチは vCenter サーバによって制御され、各ホストの物理インターフェイスにマッピングされたポートグループを作成することによって、各ホストの接続を一元的に設定および管理できます。




== Anthos の場合

Anthos は、 Kubernetes を使用したハイブリッドクラウド対応データセンター解決策です。最新のハイブリッドクラウドインフラを構築、管理しつつ、アプリケーション開発に重点を置いた即応性に優れたワークフローを採用できます。オープンソーステクノロジを基盤とした解決策を基盤とする Anthos は、 VMware vSphere ベースのインフラにオンプレミスで稼働し、 Google Cloud の Anthos GKE との接続と相互運用が可能です。コンテナ、サービスメッシュ、その他の変革テクノロジを採用することで、ローカルおよびクラウドベースの環境で一貫したアプリケーション開発サイクルと本番環境対応のワークロードを体験できるようになります。次の図は、 Anthos 解決策と、オンプレミスのデータセンターに導入し、クラウドのインフラと相互接続する方法を示しています。Anthos の詳細については、 Anthos の Web サイトを参照してください https://cloud.google.com/anthos/["こちらをご覧ください"]。

Anthos には次のような機能があります。

* * Anthos の構成管理。 * ハイブリッド Kubernetes 環境のポリシーとセキュリティを自動化します。
* * Anthos サービスメッシュ * は、 Istio 電源のサービスメッシュにより、アプリケーションのオブザーバビリティ、セキュリティ、および制御を強化します。
* * Google Cloud Marketplace for Kubernetes Applications 。 * キュレーションされたコンテナアプリケーションのカタログを利用して、簡単に導入できます。
* * Anthos * に移行。オンプレミスからクラウドへの物理サービスと VM の自動移行を実現します。
* *Stackdriver. * クラウド・インスタンスのロギングと監視のために Google が提供する管理サービス。


image::anthos_architecture.png[Anthos アーキテクチャ]



=== コンテナと Kubernetes のオーケストレーション

コンテナテクノロジは、開発者が長期間利用できるようになっています。しかし、アプリケーション固有のワークロード要件を採用する企業が増えるにつれ、データセンターのアーキテクチャと設計の中核となる概念になってきました。

従来の開発環境では、ベアメタルサーバまたは仮想サーバ上に専用の開発ホストを導入する必要があります。このような環境では、各アプリケーションに、オペレーティングシステム（ OS ）とネットワーク接続を備えた専用のマシンが必要です。これらのマシンは、多くの場合、エンタープライズシステム管理チームが管理する必要があります。管理チームは、インストールされているアプリケーションのバージョンとホスト OS のパッチを考慮する必要があります。一方、設計上のコンテナの導入に必要なオーバーヘッドは少なくて済みます。必要なのは、アプリケーションコードとサポートライブラリのパッケージ化だけです。その他のサービスはすべてホスト OS に依存しているためです。開発者は、完全な仮想マシン（ VM ）環境を管理するのではなく、アプリケーション開発プロセスに集中できます。

コンテナ技術が企業環境に魅力を感じ始めたとき、フォールトトレランスやアプリケーションの拡張など、多くのエンタープライズ機能が要求され、期待されていました。それに応えて、 Google は Linux Foundation と提携し、 Cloud Native Computing Foundation （ CNCF ）を設立しました。Kubernetes （ Kubernetes ）も一緒に導入されました。 Kubernetes は、コンテナをオーケストレーションおよび管理するためのオープンソースプラットフォームです。Kubernetes は、 Google が過去 10 年間にデータセンターで使用されていた Omega と Borg の両方のコンテナ管理プラットフォームの後継となるように設計されています。



=== アントス GKE

Anthos GKE は、 Google Cloud で認定された Kubernetes ディストリビューションです。エンドユーザは、管理された本番環境対応の Kubernetes クラスタを簡単に導入できるため、開発者は環境の管理ではなく、主にアプリケーション開発に集中できます。Anthos GKE に Kubernetes クラスタを導入すると、次のようなメリットがあります。

* * アプリケーションの導入を簡素化 * Anthos GKE は、アプリケーションとサービスの迅速な開発、導入、更新を可能にします。Kubernetes Engine は、アプリケーションコンテナで必要とされるシステムリソース（コンピューティング、メモリ、ストレージ）を簡単に説明することで、クラスタ環境のライフサイクルを自動的にプロビジョニングおよび管理します。
* * クラスターの可用性を確保 * 環境は、 Google Cloud コンソールに組み込まれたダッシュボードを使用して、極めてアクセスしやすく、管理も容易になります。Anthos GKE クラスタは、 Google Site Reliability Engineers （ SRE ）によって継続的に監視され、定期的な指標を収集し、割り当てられたシステムリソースの使用状況を監視することで、クラスタが期待どおりに動作することを確認します。ユーザーは、使用可能なヘルスチェックを利用して、展開されたアプリケーションの可用性が高く、何か問題が発生した場合に簡単に回復できることを確認することもできます。
* * Google Cloud のクラスターを保護します。 * エンドユーザーは、 Google Cloud のグローバル仮想プライベートクラウドから利用できるネットワークポリシーをカスタマイズすることにより、クラスターのセキュリティとアクセス性を確保できます。パブリックサービスは、ロードバランシングのために、単一のグローバル IP アドレスの背後に配置できます。単一の IP は、アプリケーションの高可用性を提供し、サービスパフォーマンスを低下させる可能性のある分散型サービス妨害（ DDoS ）などの攻撃から保護するのに役立ちます。
* * 要件に合わせて簡単に拡張できます。 * エンドユーザーは、クラスターの自動スケーリングを有効にして、アプリケーションの要求が計画的にも予期しない増加にも容易に対応できます。自動拡張機能により、需要の高い時間帯に容量を増やして、システムリソースを常に使用できるようにすることができます。また、需要がピークに達したあともクラスタを以前の状態およびサイズに戻すことができます。




=== VMware 上の Anthos

VMware 上の Anthos は、エンドユーザのプライベートデータセンターに導入されている Google Kubernetes Engine の拡張機能です。組織は、オンプレミスの Kubernetes クラスタ内の Google Cloud 内のコンテナで実行するように設計されたものと同じアプリケーションを導入できます。VMware 上の Anthos には次のようなメリットがあります。

* * コスト削減。 * エンドユーザーは、 Google Cloud 環境でリソースをプロビジョニングする代わりに、アプリケーションの導入に独自の物理リソースを使用することで、大幅なコスト削減を実現できます。
* * 開発、公開 * オンプレミス環境は、アプリケーション開発中に使用できます。これにより、クラウドで公開される前に、ローカルデータセンターのプライバシーでアプリケーションをテストできます。
* * セキュリティー要件。 * セキュリティーの懸念が高まるお客様や、パブリッククラウドに保存できない機密データセットをお持ちのお客様は、自社のデータセンターのセキュリティーからアプリケーションを実行できるため、組織の要件を満たすことができます。


link:anthos_reference_design_considerations.html["次：設計上の考慮事項"]
