---
sidebar: sidebar 
permalink: ehc/ehc-overview.html 
keywords: NetApp Solutions, hybrid, multicloud, multi cloud, enterprise hybrid cloud, hyperscalers, vmware 
summary:  
---
= VMwareを使用したネットアップのハイブリッドマルチクラウドの概要
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/


[role="lead"]
ほとんどの IT 組織は、ハイブリッドクラウドファーストアプローチに準拠しています。このような組織は変革の段階にあり、お客様は現在の IT 環境を評価してから、評価と調査の演習に基づいてワークロードをクラウドに移行しています。

クラウドに移行するお客様の要因には、柔軟性とバースト性、データセンターの終了、データセンターの統合、サポート終了シナリオ、合併、 買収など。この移行の理由は、各組織とそれぞれのビジネス上の優先事項によって異なります。ハイブリッドクラウドに移行する際は、クラウドの導入と柔軟性を最大限に活用するために、クラウドに最適なストレージを選択することがきわめて重要です。



== パブリッククラウドの VMware Cloud オプション



=== Azure VMware 解決策の略

image::avs-logo.png[AVS,60,60]

Azure VMware 解決策は、 Microsoft Azure パブリッククラウド内で VMware データセンターを完全に機能させるハイブリッドクラウドサービスです。Azure VMware 解決策は、 Microsoft がフルマネージドでサポートし、 VMware が Azure インフラを活用して検証した、ファーストパーティ製解決策です。つまり、 Azure VMware 解決策を導入すると、お客様のコンピューティング仮想化向けに VMware の ESXi を、ハイパーコンバージドストレージ用に vSAN を、 さらに NSX は、ネットワークとセキュリティを実現するだけでなく、 Microsoft Azure のグローバルプレゼンス、クラスをリードするデータセンター施設を活用し、ネイティブの Azure サービスとソリューションの豊富なエコシステムに近接しています。



=== AWS 上の VMware Cloud

image::vmc-logo.png[VM C,60,60]

VMware Cloud on AWS は、 VMware のエンタープライズクラスの SDDC ソフトウェアを AWS クラウドに提供し、ネイティブ AWS サービスへのアクセスを最適化します。VMware Cloud Foundation を基盤とする VMware Cloud on AWS は、 VMware のコンピューティング、ストレージ、ネットワーク仮想化製品（ VMware vSphere 、 VMware vSAN 、 VMware NSX ）と VMware vCenter Server の管理を統合し、専用の柔軟性の高いベアメタル AWS インフラストラクチャ上で実行できるように最適化されています。



=== Google Cloud VMware Engine

image::gcve-logo.png[「 gcve 」,60,60]

Google Cloud VMware Engine は、 Google Cloud の高性能で拡張性の高いインフラストラクチャと VMware Cloud Foundation スタック（ VMware vSphere 、 vCenter 、 VSAN 、 NSX ）を基盤とした IaaS （ Infrastructure-as-a-Service ）ですこのサービスにより、アプリケーションの再構築やツールの再構築にかかるコスト、労力、リスクを伴わずに、クラウドへの迅速な移行を実現し、既存の VMware ワークロードをオンプレミス環境から Google Cloud Platform にシームレスに移行または拡張できます。VMware と緊密に連携して Google が販売およびサポートするサービスです。


NOTE: SDDC プライベートクラウドと NetApp Cloud Volume コロケーション施設は、最小限のネットワークレイテンシで最高のパフォーマンスを提供します。



== ご存知ですか？

VMware SDDC を導入する際、使用するクラウドに関係なく、最初のクラスタには次の製品が含まれます。

* コンピューティングの仮想化に使用する VMware ESXi ホストと、管理用の vCenter Server アプライアンス
* 各 ESXi ホストの物理ストレージ資産を組み込んだ VMware vSAN ハイパーコンバージドストレージ
* 管理のために NSX Manager クラスタを使用した仮想ネットワークとセキュリティのための VMware NSX




== ストレージ構成

ストレージを大量に消費するワークロードをホストし、クラウドホスト型の VMware 解決策でスケールアウトする場合、デフォルトのハイパーコンバージドインフラでは、コンピューティングリソースとストレージリソースの両方で拡張を行う必要があります。

Azure NetApp Files 、 NetApp ONTAP 向け Amazon FSX 、 Cloud Volumes ONTAP （ 3 つの主要ハイパースケーラすべてに対応）、 Cloud Volumes Service for Google Cloud などの NetApp Cloud Volume と統合することで、お客様はストレージを個別に拡張できるオプションを利用できるようになりました。 また、必要に応じてコンピューティングノードを SDDC クラスタに追加します。



=== 注：

* VMware では、アンバランスなクラスタ構成を推奨していません。そのため、ストレージを拡張するとホストが増え、 TCO が増加します。
* 1 つの VSAN 環境のみが可能です。そのため、すべてのストレージトラフィックが本番環境のワークロードと直接競合します。
* アプリケーションの要件、パフォーマンス、コストに合わせて複数のパフォーマンス階層を提供するオプションはありません。
* クラスタホスト上に構築された VSAN のストレージ容量の制限に非常に簡単に到達できます。NetApp Cloud Volume を使用して、アクティブなデータセットをホストするか、またはティアクーラデータを永続的ストレージにホストするかに応じてストレージを拡張できます。


Azure NetApp Files 、 NetApp ONTAP 向け Amazon FSX 、 Cloud Volumes ONTAP （ 3 つの主要なハイパースケーラすべてで利用可能）、および Cloud Volumes Service for Google Cloud は、ゲスト VM と組み合わせて使用できます。このハイブリッドストレージアーキテクチャは、ゲストオペレーティングシステムとアプリケーションバイナリデータを保持する VSAN データストアで構成されます。アプリケーションデータは、ゲストベースの iSCSI イニシエータを介して VM に接続されます。または、 Amazon FSX for NetApp ONTAP 、 Cloud Volume ONTAP 、 Azure NetApp Files 、 Cloud Volumes Service for Google Cloud と直接通信する NFS/SMB マウントを使用して VM に接続されます。この構成では、 VSAN と同様にストレージ容量の問題を簡単に解決できます。使用可能な空きスペースは、使用する余裕容量およびストレージポリシーによって異なります。

次に、 AWS 上の VMware Cloud 上の 3 ノード SDDC クラスタについて考えてみましょう。

* 3 ノード SDDC の合計物理容量は 31.1TB （各ノードのおおよその 10TB ）です。
* 追加のホストが追加される前に保持されるスラックスペース = 25% = （ .25 x 31.1TB ） = 7.7TB 。
* 余裕期間を計算した後の使用可能な物理容量 = 23.4TB
* 使用可能な有効な空きスペースは、適用するストレージポリシーによって異なります。
+
例：

+
** RAID 0 = 有効な空きスペース = 23.4TB （使用可能な物理容量 / 1 ）
** RAID 1 = 有効な空きスペース = 11.7TB （使用可能な物理容量 / 2 ）
** RAID 5 = 有効な空きスペース = 17.5TB （使用可能な物理容量 / 1.33 ）




そのため、 NetApp Cloud Volume をゲスト接続ストレージとして使用すると、パフォーマンスとデータ保護の要件を満たしながら、ストレージを拡張して TCO を最適化できます。


NOTE: 本ドキュメントの作成時点で使用可能な唯一のオプションは、ゲスト内ストレージでした。NFSデータストアの補足サポートが提供されるようになりましたが、それ以外のドキュメントも提供されます link:https://docs.netapp.com/us-en/netapp-solutions/ehc/index.html["こちらをご覧ください"]。



=== 覚えておいてください

* ハイブリッドストレージモデルでは、ホスト自体にも近接しているため、特定のレイテンシ要件に対処するために、 VSAN データストアにティア 1 または高優先度のワークロードを配置します。トランザクションのレイテンシが許容されるワークロード VM には、ゲスト内メカニズムを使用します。
* NetApp SnapMirror ® テクノロジを使用して、オンプレミスの ONTAP システムから Cloud Volumes ONTAP または Amazon FSX for NetApp ONTAP にワークロードデータをレプリケートすることで、ブロックレベルのメカニズムによって移行を簡易化できます。これは、 Azure NetApp Files および Cloud Volume サービスには適用されません。Azure NetApp Files または Cloud Volume サービスにデータを移行するには、使用するファイルプロトコルに応じて、 NetApp XCP 、 Cloud Sync 、 rysnc 、 robocopy を使用してください。
* テストでは、該当する SDDC からストレージにアクセスする際のレイテンシが 2 ～ 4 ミリ秒増加しました。ストレージをマッピングする際には、このレイテンシをアプリケーション要件に考慮してください。
* テストフェイルオーバーおよび実際のフェイルオーバー時にゲスト接続ストレージをマウントする場合は、 iSCSI イニシエータが再設定されていること、 SMB 共有の DNS が更新されていること、および NFS マウントポイントが fstab で更新されていることを確認してください。
* ゲスト内の Microsoft Multipath I/O （ MPIO ；マルチパス I/O ）、ファイアウォール、ディスクタイムアウトのレジストリ設定が VM 内で適切に設定されていることを確認します。



NOTE: この環境ゲスト接続ストレージのみ。



== ネットアップのクラウドストレージのメリット

ネットアップのクラウドストレージには次のようなメリットがあります。

* コンピューティングとストレージの別々にストレージを拡張できるため、コンピューティングとストレージの密度が向上します。
* ホスト数を削減し、全体的な TCO を削減できます。
* コンピューティングノードの障害は、ストレージのパフォーマンスには影響しません。
* Azure NetApp Files のボリュームの形状変更と動的なサービスレベル機能を使用すると、安定状態のワークロードのサイジングによってコストを最適化し、オーバープロビジョニングを防止できます。
* Cloud Volumes ONTAP の Storage Efficiency 、クラウド階層化、インスタンスタイプの変更機能を使用すると、ストレージの追加や拡張を最適な方法で行うことができます。
* ストレージリソースのオーバープロビジョニングは、必要な場合にのみ発生します。
* 効率的な Snapshot コピーとクローンにより、パフォーマンスに影響を与えることなく迅速にコピーを作成できます。
* Snapshot コピーからの迅速なリカバリを使用して、ランサムウェア攻撃に対処できます。
* 複数のリージョン間で効率的なブロック転送ベースのリージョナルディザスタリカバリと統合されたバックアップブロックレベルを提供することで、 RPO と RTO が向上します。




== 前提条件

* SnapMirror テクノロジやその他の関連するデータ移行メカニズムが有効になっている。オンプレミスから任意のハイパースケーラクラウドまで、さまざまな接続オプションがあります。適切なパスを使用し、関連するネットワークチームと連携します。
* 本ドキュメントの作成時点で使用可能な唯一のオプションは、ゲスト内ストレージでした。NFSデータストアの補足サポートが提供されるようになりましたが、それ以外のドキュメントも提供されます link:https://docs.netapp.com/us-en/netapp-solutions/ehc/index.html["こちらをご覧ください"]。



NOTE: ストレージの計画とサイジング、および必要なホスト数については、ネットアップの解決策アーキテクトと対応するハイパースケーラクラウドアーキテクトに相談してください。Cloud Volumes ONTAP サイジングツールを使用してストレージインスタンスのタイプや適切なサービスレベルを最終決定する前に、ストレージのパフォーマンス要件を特定することを推奨します。



== 詳細なアーキテクチャ

このアーキテクチャ（下の図を参照）では、NetApp Cloud Volumes ONTAP 、Cloud Volumes Service for Google Cloud、Azure NetApp Files を追加のゲスト内ストレージオプションとして使用して、複数のクラウドプロバイダ間でハイブリッドマルチクラウド接続とアプリケーションのモビリティを実現する方法を大まかに説明します。

image:ehc-architecture.png["エンタープライズハイブリッドクラウドアーキテクチャ"]
